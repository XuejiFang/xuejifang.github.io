<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HA-DW: Your Group-Relative Advantage Is Biased</title>
    <link rel="shortcut icon" href="../../images/favicon/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <style>
        :root {
            --primary: #1a73e8;
            --primary-light: #4285f4;
            --primary-dark: #1557b0;
            --theorem-bg: #fff8e6;
            --theorem-border: #f5a623;
            --lemma-bg: #e8f4fd;
            --lemma-border: #1a73e8;
            --corollary-bg: #e6f4ea;
            --corollary-border: #34a853;
            --problem-color: #ea4335;
            --solution-color: #1a73e8;
            --generalization-color: #9334e6;
            --bg-page: #f8f9fa;
            --bg-card: #ffffff;
            --bg-sidebar: #ffffff;
            --text-primary: #202124;
            --text-secondary: #5f6368;
            --border-color: #e0e0e0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans SC', sans-serif;
            background: var(--bg-page);
            color: var(--text-primary);
            line-height: 1.7;
            font-size: 15px;
        }

        /* Page Layout */
        .page-wrapper {
            display: flex;
            min-height: 100vh;
        }

        /* Left Sidebar Navigation */
        .sidebar {
            width: 220px;
            background: var(--bg-sidebar);
            border-right: 1px solid var(--border-color);
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            overflow-y: auto;
            padding: 20px 0;
            z-index: 100;
        }

        .sidebar-header {
            padding: 10px 20px 20px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 15px;
        }

        .sidebar-header .back-link {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .sidebar-header .back-link:hover {
            color: var(--primary);
        }

        .sidebar-header h2 {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.4;
        }

        .sidebar-nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sidebar-nav li {
            margin: 2px 0;
        }

        .sidebar-nav a {
            display: block;
            padding: 10px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            border-left: 3px solid transparent;
            transition: all 0.2s;
        }

        .sidebar-nav a:hover {
            background: #f1f3f4;
            color: var(--text-primary);
        }

        .sidebar-nav a.active {
            background: #e8f0fe;
            color: var(--primary);
            border-left-color: var(--primary);
            font-weight: 500;
        }

        .sidebar-nav .nav-section {
            padding: 15px 20px 8px;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* View Toggle in Sidebar */
        .view-toggle {
            padding: 15px 20px;
            border-top: 1px solid var(--border-color);
            margin-top: 15px;
        }

        .view-toggle-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .view-toggle-btns {
            display: flex;
            gap: 6px;
        }

        .view-toggle button {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-card);
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }

        .view-toggle button:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .view-toggle button.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Main Content Area */
        .main-content {
            flex: 1;
            margin-left: 220px;
            padding: 40px 60px;
            max-width: 1000px;
        }

        /* Header Section */
        .article-header {
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 1px solid var(--border-color);
        }

        .article-header h1 {
            font-size: 28px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 12px;
            line-height: 1.3;
        }

        .article-header .subtitle {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .article-header .meta {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .article-header .meta a {
            color: var(--primary);
            text-decoration: none;
        }

        .article-header .meta a:hover {
            text-decoration: underline;
        }

        /* Section Styles */
        .section {
            margin-bottom: 50px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
            display: inline-block;
        }

        /* Content Card */
        .content-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            border: 1px solid var(--border-color);
        }

        .content-card p {
            color: var(--text-secondary);
            margin-bottom: 12px;
            line-height: 1.8;
        }

        .content-card p:last-child {
            margin-bottom: 0;
        }

        /* Theory Structure Cards */
        .structure-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 900px) {
            .structure-grid {
                grid-template-columns: 1fr;
            }
        }

        .structure-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }

        .structure-card.problem {
            border-left-color: var(--problem-color);
        }

        .structure-card.solution {
            border-left-color: var(--solution-color);
        }

        .structure-card.generalization {
            border-left-color: var(--generalization-color);
        }

        .structure-card h3 {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .structure-card.problem h3 {
            color: var(--problem-color);
        }

        .structure-card.solution h3 {
            color: var(--solution-color);
        }

        .structure-card.generalization h3 {
            color: var(--generalization-color);
        }

        .structure-card .subtitle {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .structure-card p {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .structure-card .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .structure-card .tag {
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }

        .structure-card.problem .tag {
            background: #fce8e6;
            color: var(--problem-color);
        }

        .structure-card.solution .tag {
            background: #e8f0fe;
            color: var(--solution-color);
        }

        .structure-card.generalization .tag {
            background: #f3e8fd;
            color: var(--generalization-color);
        }

        /* Dependency Flow */
        .flow-container {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            border: 1px solid var(--border-color);
            overflow-x: auto;
        }

        .flow-section {
            border: 2px dashed var(--border-color);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            position: relative;
        }

        .flow-section:last-child {
            margin-bottom: 0;
        }

        .flow-section-label {
            position: absolute;
            top: -10px;
            left: 15px;
            padding: 2px 12px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 600;
            color: white;
        }

        .flow-section.problem .flow-section-label {
            background: var(--problem-color);
        }

        .flow-section.solution .flow-section-label {
            background: var(--solution-color);
        }

        .flow-section.generalization .flow-section-label {
            background: var(--generalization-color);
        }

        .flow-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
            margin: 10px 0;
        }

        .flow-node {
            background: var(--bg-card);
            border-radius: 8px;
            padding: 10px 16px;
            text-align: center;
            border: 2px solid;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 100px;
        }

        .flow-node:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .flow-node.theorem {
            border-color: var(--theorem-border);
            background: var(--theorem-bg);
        }

        .flow-node.lemma {
            border-color: var(--lemma-border);
            background: var(--lemma-bg);
        }

        .flow-node.corollary {
            border-color: var(--corollary-border);
            background: var(--corollary-bg);
        }

        .flow-node .node-type {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 2px;
        }

        .flow-node.theorem .node-type { color: var(--theorem-border); }
        .flow-node.lemma .node-type { color: var(--lemma-border); }
        .flow-node.corollary .node-type { color: var(--corollary-border); }

        .flow-node .node-name {
            font-weight: 600;
            font-size: 13px;
            color: var(--text-primary);
        }

        .flow-node .node-desc {
            font-size: 10px;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        .flow-arrow {
            color: var(--text-secondary);
            font-size: 18px;
        }

        .flow-arrow-down {
            text-align: center;
            color: var(--text-secondary);
            font-size: 18px;
            margin: 8px 0;
        }

        /* Symbol Grid */
        .symbol-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 12px;
        }

        .symbol-item {
            background: var(--bg-card);
            border-radius: 8px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            border: 1px solid var(--border-color);
        }

        .symbol-item .symbol {
            font-size: 16px;
            color: var(--primary);
            min-width: 50px;
        }

        .symbol-item .desc {
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* Theory Cards */
        .theory-card {
            background: var(--bg-card);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            border: 1px solid var(--border-color);
        }

        .theory-card .card-header {
            padding: 16px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .theory-card.theorem .card-header {
            background: var(--theorem-bg);
            border-bottom: 2px solid var(--theorem-border);
        }

        .theory-card.lemma .card-header {
            background: var(--lemma-bg);
            border-bottom: 2px solid var(--lemma-border);
        }

        .theory-card.corollary .card-header {
            background: var(--corollary-bg);
            border-bottom: 2px solid var(--corollary-border);
        }

        .theory-card .badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .theory-card.theorem .badge {
            background: var(--theorem-border);
            color: white;
        }

        .theory-card.lemma .badge {
            background: var(--lemma-border);
            color: white;
        }

        .theory-card.corollary .badge {
            background: var(--corollary-border);
            color: white;
        }

        .theory-card .card-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .theory-card .card-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .theory-card .card-body {
            padding: 20px;
        }

        .theory-card .card-desc {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.7;
        }

        .theory-card .card-math {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            overflow-x: auto;
            font-size: 14px;
            border: 1px solid var(--border-color);
        }

        .theory-card .card-footer {
            padding: 12px 20px;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
            font-size: 12px;
        }

        .theory-card .dep-label {
            color: var(--text-secondary);
        }

        .theory-card .dep-tag {
            padding: 3px 10px;
            border-radius: 10px;
            background: #e8e8e8;
            color: var(--text-secondary);
            font-size: 11px;
        }

        /* Insight Box */
        .insight-box {
            background: var(--theorem-bg);
            border-left: 4px solid var(--theorem-border);
            border-radius: 0 8px 8px 0;
            padding: 15px 20px;
            margin: 15px 0;
        }

        .insight-box .title {
            font-weight: 600;
            color: var(--theorem-border);
            margin-bottom: 8px;
            font-size: 14px;
        }

        .insight-box p {
            color: var(--text-secondary);
            font-size: 13px;
            line-height: 1.6;
        }

        /* Cards Grid */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 20px;
        }

        @media (max-width: 500px) {
            .cards-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Experiment Section */
        .exp-card {
            background: var(--bg-card);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            border: 1px solid var(--border-color);
        }

        .exp-card .exp-header {
            padding: 16px 20px;
            background: #f8f9fa;
            border-bottom: 1px solid var(--border-color);
        }

        .exp-card .exp-header h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .exp-card .exp-header p {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .exp-card .exp-body {
            padding: 20px;
        }

        .exp-card img {
            width: 100%;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
        }

        .exp-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .exp-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
        }

        .exp-item h4 {
            font-size: 14px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .exp-item ul {
            list-style: none;
            padding: 0;
        }

        .exp-item li {
            font-size: 13px;
            color: var(--text-secondary);
            padding: 4px 0;
            padding-left: 16px;
            position: relative;
        }

        .exp-item li::before {
            content: '›';
            position: absolute;
            left: 0;
            color: var(--primary);
            font-weight: bold;
        }

        .exp-item p {
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        .legend-dot.theorem { background: var(--theorem-border); }
        .legend-dot.lemma { background: var(--lemma-border); }
        .legend-dot.corollary { background: var(--corollary-border); }

        /* Footer */
        .footer {
            text-align: center;
            padding: 30px 20px;
            border-top: 1px solid var(--border-color);
            color: var(--text-secondary);
            font-size: 13px;
            margin-top: 40px;
        }

        .footer a {
            color: var(--primary);
            text-decoration: none;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-card);
            border-radius: 12px;
            max-width: 650px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #f1f3f4;
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: #e8e8e8;
        }

        /* Markdown View */
        .markdown-view {
            display: none;
        }

        .markdown-view.active {
            display: block;
        }

        .markdown-article {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            border: 1px solid var(--border-color);
        }

        .markdown-article h1 {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
        }

        .markdown-article h2 {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin-top: 30px;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
        }

        .markdown-article h3 {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary);
            margin-top: 25px;
            margin-bottom: 12px;
        }

        .markdown-article p {
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .markdown-article ul, .markdown-article ol {
            color: var(--text-secondary);
            margin-bottom: 15px;
            padding-left: 25px;
        }

        .markdown-article li {
            margin-bottom: 8px;
        }

        .markdown-article blockquote {
            border-left: 4px solid var(--primary);
            margin: 20px 0;
            padding: 15px 20px;
            background: #f8f9fa;
            color: var(--text-secondary);
            border-radius: 0 8px 8px 0;
        }

        .markdown-article code {
            background: #f1f3f4;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'SF Mono', Consolas, monospace;
            font-size: 0.9em;
        }

        .markdown-article pre {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 16px;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid var(--border-color);
        }

        .markdown-article pre code {
            background: none;
            padding: 0;
        }

        .markdown-article img {
            max-width: 100%;
            border-radius: 8px;
            margin: 15px 0;
        }

        .markdown-article strong {
            color: var(--text-primary);
        }

        .visual-view {
            display: block;
        }

        .visual-view.hidden {
            display: none;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }

            .main-content {
                margin-left: 0;
                padding: 20px;
            }

            .cards-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="page-wrapper">
        <!-- Left Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../" class="back-link">← Back to Blog</a>
                <h2>HA-DW Paper Reading</h2>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="#basic" class="active" onclick="scrollToSection('basic')">0. Basic Info</a></li>
                    <li><a href="#problem" onclick="scrollToSection('problem')">1. Problem & Motivation</a></li>
                    <li><a href="#structure" onclick="scrollToSection('structure')">2. Theory Structure</a></li>
                    <li><a href="#dependency" onclick="scrollToSection('dependency')">3. Dependency Graph</a></li>
                    <li class="nav-section">Theorems</li>
                    <li><a href="#theorems" onclick="scrollToSection('theorems')">4. Theorems</a></li>
                    <li><a href="#lemmas" onclick="scrollToSection('lemmas')">5. Lemmas</a></li>
                    <li><a href="#corollaries" onclick="scrollToSection('corollaries')">6. Corollaries</a></li>
                    <li class="nav-section">Experiments</li>
                    <li><a href="#experiments" onclick="scrollToSection('experiments')">7. Experiments</a></li>
                </ul>
            </nav>
            <div class="view-toggle">
                <div class="view-toggle-label">View Mode</div>
                <div class="view-toggle-btns">
                    <button id="btn-visual" class="active" onclick="showView('visual')">Visual</button>
                    <button id="btn-md" onclick="showView('md')">Markdown</button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Visual View -->
            <div id="visual-view" class="visual-view">
                <!-- Header -->
                <header class="article-header" id="basic">
                    <h1>Your Group-Relative Advantage Is Biased</h1>
                    <p class="subtitle">HA-DW: History-Aware Difficulty Weighting for Debiased Group-Relative Advantage in RLHF</p>
                    <p class="meta">
                        <strong>Authors:</strong> Fengkai Yang, Zherui Chen, Xiaohan Wang, et al.<br>
                        <strong>Affiliations:</strong> BUAA, UC Berkeley, PKU, Meituan<br>
                        <strong>Resources:</strong> <a href="assets/paper.pdf" target="_blank">PDF</a> · <a href="main.md" target="_blank">Notes</a>
                    </p>
                </header>

                <!-- Abstract -->
                <section class="section" id="problem">
                    <h2 class="section-title">1. Problem & Motivation</h2>
                    <div class="content-card">
                        <p>
                            This paper proposes an <strong>adaptive advantage reweighting</strong> optimization algorithm (HA-DW) to mitigate bias induced by group-based advantage estimation.
                        </p>
                        <p>
                            <strong>Core Finding:</strong> The expectation of group-based advantage estimation $\hat{A}_{t,i}$ is <span style="color: var(--problem-color); font-weight: 600;">underestimated for difficult prompts</span> and <span style="color: var(--corollary-border); font-weight: 600;">overestimated for easy prompts</span>. This means algorithms like GRPO have systematic bias during training.
                        </p>
                        <p>
                            <strong>Solution:</strong> Two key components: (1) Cross-batch information framework for history-aware prompt difficulty anchoring; (2) Adaptive advantage reweighting algorithm to correct bias. With appropriate $\lambda_{scale}$, HA-DW adjusted advantage estimates are closer to true advantage in expectation.
                        </p>
                    </div>
                </section>

                <!-- Theory Structure -->
                <section class="section" id="structure">
                    <h2 class="section-title">2. Theory Structure</h2>
                    <div class="structure-grid">
                        <div class="structure-card problem">
                            <h3>Part I: Reveal Bias</h3>
                            <div class="subtitle">The Problem</div>
                            <p>Prove that Group-Relative Advantage estimation is mathematically biased</p>
                            <div class="tags">
                                <span class="tag">Theorem 1</span>
                                <span class="tag">Theorem 2</span>
                                <span class="tag">Lemma 2</span>
                                <span class="tag">Corollary 1-3</span>
                            </div>
                        </div>
                        <div class="structure-card solution">
                            <h3>Part II: Solve Bias</h3>
                            <div class="subtitle">The Solution</div>
                            <p>Derive how to eliminate bias through correction coefficient $\lambda_{scale}$</p>
                            <div class="tags">
                                <span class="tag">Theorem 3</span>
                                <span class="tag">Lemma 1</span>
                                <span class="tag">Lemma 3-6</span>
                            </div>
                        </div>
                        <div class="structure-card generalization">
                            <h3>Part III: Generalization</h3>
                            <div class="subtitle">Extension</div>
                            <p>Prove bias exists not only in binary rewards, but also in continuous rewards</p>
                            <div class="tags">
                                <span class="tag">Theorem 4</span>
                                <span class="tag">Corollary 4-5</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Dependency Graph -->
                <section class="section" id="dependency">
                    <h2 class="section-title">3. Dependency Graph</h2>
                    <div class="legend">
                        <div class="legend-item">
                            <div class="legend-dot theorem"></div>
                            <span>Theorem</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-dot lemma"></div>
                            <span>Lemma</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-dot corollary"></div>
                            <span>Corollary</span>
                        </div>
                    </div>
                    <div class="flow-container">
                        <!-- Problem Section -->
                        <div class="flow-section problem">
                            <span class="flow-section-label">Part I: Reveal Bias</span>
                            <div class="flow-row" style="margin-top: 10px;">
                                <div class="flow-node lemma" onclick="showModal('lemma2')">
                                    <div class="node-type">Lemma</div>
                                    <div class="node-name">Lemma 2</div>
                                    <div class="node-desc">Bias Quantification</div>
                                </div>
                            </div>
                            <div class="flow-arrow-down">↓</div>
                            <div class="flow-row">
                                <div class="flow-node theorem" onclick="showModal('theorem1')">
                                    <div class="node-type">Theorem</div>
                                    <div class="node-name">Theorem 1</div>
                                    <div class="node-desc">Bias Existence</div>
                                </div>
                                <span class="flow-arrow">→</span>
                                <div class="flow-node theorem" onclick="showModal('theorem2')">
                                    <div class="node-type">Theorem</div>
                                    <div class="node-name">Theorem 2</div>
                                    <div class="node-desc">Bias Distribution</div>
                                </div>
                            </div>
                            <div class="flow-arrow-down">↓</div>
                            <div class="flow-row">
                                <div class="flow-node corollary" onclick="showModal('corollary1')">
                                    <div class="node-type">Corollary</div>
                                    <div class="node-name">Corollary 1</div>
                                    <div class="node-desc">G≤8</div>
                                </div>
                                <div class="flow-node corollary" onclick="showModal('corollary2')">
                                    <div class="node-type">Corollary</div>
                                    <div class="node-name">Corollary 2</div>
                                    <div class="node-desc">G≥6</div>
                                </div>
                                <div class="flow-node corollary" onclick="showModal('corollary3')">
                                    <div class="node-type">Corollary</div>
                                    <div class="node-name">Corollary 3</div>
                                    <div class="node-desc">Sure Event</div>
                                </div>
                            </div>
                        </div>

                        <!-- Solution Section -->
                        <div class="flow-section solution">
                            <span class="flow-section-label">Part II: Solve Bias</span>
                            <div class="flow-row" style="margin-top: 10px;">
                                <div class="flow-node lemma" onclick="showModal('lemma4')">
                                    <div class="node-type">Lemma</div>
                                    <div class="node-name">Lemma 4</div>
                                    <div class="node-desc">Concentration</div>
                                </div>
                                <span class="flow-arrow">→</span>
                                <div class="flow-node lemma" onclick="showModal('lemma5')">
                                    <div class="node-type">Lemma</div>
                                    <div class="node-name">Lemma 5</div>
                                    <div class="node-desc">Confidence</div>
                                </div>
                            </div>
                            <div class="flow-arrow-down">↓</div>
                            <div class="flow-row">
                                <div class="flow-node lemma" onclick="showModal('lemma3')">
                                    <div class="node-type">Lemma</div>
                                    <div class="node-name">Lemma 3</div>
                                    <div class="node-desc">Existence</div>
                                </div>
                                <span class="flow-arrow">→</span>
                                <div class="flow-node lemma" onclick="showModal('lemma1')">
                                    <div class="node-type">Lemma</div>
                                    <div class="node-name">Lemma 1/6</div>
                                    <div class="node-desc">Baseline Range</div>
                                </div>
                            </div>
                            <div class="flow-arrow-down">↓</div>
                            <div class="flow-row">
                                <div class="flow-node theorem" onclick="showModal('theorem3')">
                                    <div class="node-type">Theorem</div>
                                    <div class="node-name">Theorem 3 ★</div>
                                    <div class="node-desc">Advantage Rectification</div>
                                </div>
                            </div>
                        </div>

                        <!-- Generalization Section -->
                        <div class="flow-section generalization">
                            <span class="flow-section-label">Part III: Generalization</span>
                            <div class="flow-row" style="margin-top: 10px;">
                                <div class="flow-node theorem" onclick="showModal('theorem4')">
                                    <div class="node-type">Theorem</div>
                                    <div class="node-name">Theorem 4</div>
                                    <div class="node-desc">Continuous Reward</div>
                                </div>
                            </div>
                            <div class="flow-arrow-down">↓</div>
                            <div class="flow-row">
                                <div class="flow-node corollary" onclick="showModal('corollary4')">
                                    <div class="node-type">Corollary</div>
                                    <div class="node-name">Corollary 4</div>
                                    <div class="node-desc">Beta Dist.</div>
                                </div>
                                <div class="flow-node corollary" onclick="showModal('corollary5')">
                                    <div class="node-type">Corollary</div>
                                    <div class="node-name">Corollary 5</div>
                                    <div class="node-desc">Truncated Gaussian</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Theorems -->
                <section class="section" id="theorems">
                    <h2 class="section-title">4. Theorems</h2>
                    <div class="cards-grid">
                        <div class="theory-card theorem">
                            <div class="card-header">
                                <span class="badge">Theorem 1</span>
                                <div>
                                    <div class="card-title">Existence of Bias</div>
                                    <div class="card-subtitle">Bias Direction</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    <strong>Core conclusion:</strong> At expectation level — <span style="color: var(--problem-color);">difficult samples are underestimated</span>, <span style="color: var(--corollary-border);">easy samples are overestimated</span>.
                                </p>
                                <div class="card-math">
                                    If $p_t < 0.5$: $\mathbb{E}[\hat{A}_{t,i}|\mathcal{S}] < A_{t,i}$<br>
                                    If $p_t > 0.5$: $\mathbb{E}[\hat{A}_{t,i}|\mathcal{S}] > A_{t,i}$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Depends:</span>
                                <span class="dep-tag">Lemma 2</span>
                            </div>
                        </div>

                        <div class="theory-card theorem">
                            <div class="card-header">
                                <span class="badge">Theorem 2</span>
                                <div>
                                    <div class="card-title">Bias Probability Distribution</div>
                                    <div class="card-subtitle">Probability Characterization</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Quantifies the probability of deviation exceeding $\epsilon$ for both hard and easy samples.
                                </p>
                                <div class="card-math">
                                    $\mathbb{P}(A_{t,i} - \hat{A}_{t,i} > \epsilon | \mathcal{S})$ = [binomial sum formula]
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Depends:</span>
                                <span class="dep-tag">Theorem 1</span>
                            </div>
                        </div>

                        <div class="theory-card theorem">
                            <div class="card-header">
                                <span class="badge">Theorem 3</span>
                                <div>
                                    <div class="card-title">Advantage Rectification ★</div>
                                    <div class="card-subtitle">HA-DW Foundation</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    <strong>Key theorem!</strong> Proves that if $\lambda_{scale}$ falls in specific interval, corrected advantage bias becomes smaller.
                                </p>
                                <div class="card-math">
                                    $|\mathbb{E}[\hat{A}_{t,i} \cdot \Phi_{t,i} | \mathcal{S}] - A_{t,i}| < |\mathbb{E}[\hat{A}_{t,i} | \mathcal{S}] - A_{t,i}|$
                                </div>
                                <div class="insight-box">
                                    <div class="title">Key Insight</div>
                                    <p>Maps baseline correction coefficient c range to algorithm hyperparameter $\lambda_{scale}$ range.</p>
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Depends:</span>
                                <span class="dep-tag">Lemma 1</span>
                                <span class="dep-tag">Lemma 6</span>
                            </div>
                        </div>

                        <div class="theory-card theorem">
                            <div class="card-header">
                                <span class="badge">Theorem 4</span>
                                <div>
                                    <div class="card-title">Continuous Reward Bias</div>
                                    <div class="card-subtitle">Generalization</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Generalizes to continuous bounded reward $r_{t,i} \in [0,1]$. Proves bias is universal.
                                </p>
                                <div class="card-math">
                                    $\mathbb{E}[\hat{A}_{t,i} - A_{t,i} | \mathcal{S}_{\sigma}] = p_t - \mathbb{E}[\hat{p}_t | \mathcal{S}_{\sigma}]$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Generalizes:</span>
                                <span class="dep-tag">Theorem 1</span>
                                <span class="dep-tag">Theorem 2</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Lemmas -->
                <section class="section" id="lemmas">
                    <h2 class="section-title">5. Lemmas</h2>
                    <div class="cards-grid">
                        <div class="theory-card lemma">
                            <div class="card-header">
                                <span class="badge">Lemma 1/6</span>
                                <div>
                                    <div class="card-title">Baseline Rectification</div>
                                    <div class="card-subtitle">Core Bridge</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Finds coefficient interval $(c_{low}, c_{high})$ <strong>independent of unknown $p_t$</strong>.
                                </p>
                                <div class="card-math">
                                    $c_{low} := \sup_{p \in I_t} \frac{(p-\epsilon) A(p)}{p(1-p^{G-1})}$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Depends:</span>
                                <span class="dep-tag">Lemma 4</span>
                                <span class="dep-tag">Lemma 5</span>
                            </div>
                        </div>

                        <div class="theory-card lemma">
                            <div class="card-header">
                                <span class="badge">Lemma 2</span>
                                <div>
                                    <div class="card-title">Bias Quantification</div>
                                    <div class="card-subtitle">Math Core of Thm 1</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Provides <strong>exact mathematical expression</strong> for bias.
                                </p>
                                <div class="card-math">
                                    $A_{t,i} - \mathbb{E}[\hat{A}_{t,i}|\mathcal{S}] = \frac{p_t(1-p_t)^G + p_t^{G+1} - p_t^G}{1 - (1-p_t)^G - p_t^G}$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Used by:</span>
                                <span class="dep-tag">Theorem 1</span>
                            </div>
                        </div>

                        <div class="theory-card lemma">
                            <div class="card-header">
                                <span class="badge">Lemma 3</span>
                                <div>
                                    <div class="card-title">Correction Existence</div>
                                    <div class="card-subtitle">Existence Proof</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    If $p_t$ is known, there must exist a c that can correct bias.
                                </p>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Used by:</span>
                                <span class="dep-tag">Lemma 1</span>
                            </div>
                        </div>

                        <div class="theory-card lemma">
                            <div class="card-header">
                                <span class="badge">Lemma 4</span>
                                <div>
                                    <div class="card-title">Concentration Inequality</div>
                                    <div class="card-subtitle">Hoeffding-based</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Provides probability upper bound for $|\hat{p}_t - p_t|$. Starting point of solution.
                                </p>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Used by:</span>
                                <span class="dep-tag">Lemma 1</span>
                                <span class="dep-tag">Lemma 5</span>
                            </div>
                        </div>

                        <div class="theory-card lemma">
                            <div class="card-header">
                                <span class="badge">Lemma 5</span>
                                <div>
                                    <div class="card-title">Confidence Interval</div>
                                    <div class="card-subtitle">Safety Radius</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    With probability $\geq 1-\delta$, bounds possible range of $p_t$ via $\hat{p}_t + \epsilon_\delta$.
                                </p>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Depends:</span>
                                <span class="dep-tag">Lemma 4</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Corollaries -->
                <section class="section" id="corollaries">
                    <h2 class="section-title">6. Corollaries</h2>
                    <div class="cards-grid">
                        <div class="theory-card corollary">
                            <div class="card-header">
                                <span class="badge">Corollary 1</span>
                                <div>
                                    <div class="card-title">Bias Probability (G≤8)</div>
                                    <div class="card-subtitle">Practical Warning</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="card-math">
                                    $\mathbb{P}(\hat{A}_{t,i} < A_{t,i} | p_t < 0.5) > \mathbf{63\%}$<br>
                                    $\mathbb{P}(\hat{A}_{t,i} < A_{t,i} | p_t < 0.25) > \mathbf{78\%}$<br>
                                    $\mathbb{P}(\hat{A}_{t,i} < A_{t,i} | p_t < 0.125) = \mathbf{100\%}$
                                </div>
                            </div>
                        </div>

                        <div class="theory-card corollary">
                            <div class="card-header">
                                <span class="badge">Corollary 3</span>
                                <div>
                                    <div class="card-title">Sure Event</div>
                                    <div class="card-subtitle">Certain Bias</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Under some conditions, bias <strong>100% certainly occurs</strong>!
                                </p>
                                <div class="card-math">
                                    $p_t < \frac{1}{G} \Rightarrow \hat{A}_{t,i} < A_{t,i}$ (certain)<br>
                                    $p_t > \frac{G-1}{G} \Rightarrow \hat{A}_{t,i} > A_{t,i}$ (certain)
                                </div>
                            </div>
                        </div>

                        <div class="theory-card corollary">
                            <div class="card-header">
                                <span class="badge">Corollary 4</span>
                                <div>
                                    <div class="card-title">Beta Distribution</div>
                                    <div class="card-subtitle">Theorem 4 Example</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="card-math">
                                    $f(x) = \frac{x^{\alpha-1}(1-x)^{\beta-1}}{B(\alpha, \beta)}$<br>
                                    $p_t = \frac{\alpha}{\alpha+\beta}$
                                </div>
                            </div>
                        </div>

                        <div class="theory-card corollary">
                            <div class="card-header">
                                <span class="badge">Corollary 5</span>
                                <div>
                                    <div class="card-title">Truncated Gaussian</div>
                                    <div class="card-subtitle">Theorem 4 Example</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Demonstrates bias universality in continuous rewards.
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Experiments -->
                <section class="section" id="experiments">
                    <h2 class="section-title">7. Experiments</h2>

                    <div class="exp-card">
                        <div class="exp-header">
                            <h3>Training Pipeline</h3>
                            <p>Overall training framework of HA-DW algorithm</p>
                        </div>
                        <div class="exp-body">
                            <img src="assets/pipe.png" alt="Training Pipeline">
                        </div>
                    </div>

                    <div class="exp-card">
                        <div class="exp-header">
                            <h3>Experimental Setup</h3>
                            <p>Models, benchmarks and baselines</p>
                        </div>
                        <div class="exp-body">
                            <div class="exp-grid">
                                <div class="exp-item">
                                    <h4>Models</h4>
                                    <ul>
                                        <li>Qwen3-4B-Base</li>
                                        <li>Qwen3-8B-Base</li>
                                        <li>LLaMA-3.2-3B-Instruct</li>
                                    </ul>
                                </div>
                                <div class="exp-item">
                                    <h4>Benchmarks</h4>
                                    <ul>
                                        <li>MATH500</li>
                                        <li>AIME25, AMC23</li>
                                        <li>Minerva, OlympiadBench</li>
                                    </ul>
                                </div>
                                <div class="exp-item">
                                    <h4>Baselines</h4>
                                    <ul>
                                        <li>GRPO</li>
                                        <li>GSPO</li>
                                        <li>DAPO</li>
                                    </ul>
                                </div>
                                <div class="exp-item">
                                    <h4>Resources</h4>
                                    <p>8× NVIDIA A100 GPUs<br>VeRL framework</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="exp-card">
                        <div class="exp-header">
                            <h3>Results</h3>
                            <p>Comparison with baselines</p>
                        </div>
                        <div class="exp-body">
                            <img src="assets/exp_comp.png" alt="Comparison">
                            <img src="assets/exp_improve.png" alt="Improvement">
                        </div>
                    </div>

                    <div class="exp-card">
                        <div class="exp-header">
                            <h3>Ablation Studies</h3>
                            <p>Hyperparameter analysis</p>
                        </div>
                        <div class="exp-body">
                            <div class="exp-grid">
                                <div>
                                    <img src="assets/exp_ab1.png" alt="Lambda search">
                                </div>
                                <div>
                                    <img src="assets/exp_ab2.png" alt="Dynamic Ct">
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <footer class="footer">
                    <p>Paper Reading | HA-DW: Your Group-Relative Advantage Is Biased</p>
                    <p><a href="assets/paper.pdf" target="_blank">PDF</a> · <a href="main.md" target="_blank">Markdown Notes</a></p>
                </footer>
            </div>

            <!-- Markdown View -->
            <div id="md-view" class="markdown-view">
                <article class="markdown-article" id="markdown-content">
                    <p>Loading markdown...</p>
                </article>
            </div>
        </main>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="modal">
        <button class="modal-close" onclick="closeModal()">×</button>
        <div class="modal-content" id="modal-content"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        // KaTeX rendering
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false}
                ],
                throwOnError: false
            });
        });

        // Navigation
        function scrollToSection(id) {
            const el = document.getElementById(id);
            if (el) {
                el.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            // Update active state
            document.querySelectorAll('.sidebar-nav a').forEach(a => a.classList.remove('active'));
            event.target.classList.add('active');
        }

        // Scroll spy
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('.section, .article-header');
            let current = 'basic';

            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                if (rect.top <= 100) {
                    current = section.id;
                }
            });

            document.querySelectorAll('.sidebar-nav a').forEach(a => {
                a.classList.remove('active');
                if (a.getAttribute('href') === '#' + current) {
                    a.classList.add('active');
                }
            });
        });

        // View toggle
        let mdLoaded = false;

        function showView(view) {
            const visualView = document.getElementById('visual-view');
            const mdView = document.getElementById('md-view');
            const btnVisual = document.getElementById('btn-visual');
            const btnMd = document.getElementById('btn-md');

            if (view === 'visual') {
                visualView.classList.remove('hidden');
                mdView.classList.remove('active');
                btnVisual.classList.add('active');
                btnMd.classList.remove('active');
            } else {
                visualView.classList.add('hidden');
                mdView.classList.add('active');
                btnVisual.classList.remove('active');
                btnMd.classList.add('active');
                if (!mdLoaded) {
                    loadMarkdown();
                }
            }
        }

        function loadMarkdown() {
            fetch('main.md')
                .then(response => response.text())
                .then(text => {
                    const mathPlaceholders = [];
                    text = text.replace(/\$\$([\s\S]*?)\$\$/g, (match, formula) => {
                        mathPlaceholders.push({ type: 'block', formula: formula.trim() });
                        return `%%MATH_BLOCK_${mathPlaceholders.length - 1}%%`;
                    });
                    text = text.replace(/\$([^\$\n]+?)\$/g, (match, formula) => {
                        mathPlaceholders.push({ type: 'inline', formula: formula.trim() });
                        return `%%MATH_INLINE_${mathPlaceholders.length - 1}%%`;
                    });
                    let html = marked.parse(text);
                    mathPlaceholders.forEach((item, index) => {
                        if (item.type === 'block') {
                            html = html.replace(`%%MATH_BLOCK_${index}%%`, `$$${item.formula}$$`);
                        } else {
                            html = html.replace(`%%MATH_INLINE_${index}%%`, `$${item.formula}$`);
                        }
                    });
                    const mdContent = document.getElementById('markdown-content');
                    mdContent.innerHTML = html;
                    renderMathInElement(mdContent, {
                        delimiters: [
                            {left: '$$', right: '$$', display: true},
                            {left: '$', right: '$', display: false}
                        ],
                        throwOnError: false
                    });
                    mdLoaded = true;
                })
                .catch(err => {
                    document.getElementById('markdown-content').innerHTML = '<p style="color: #ea4335;">Failed to load markdown file.</p>';
                });
        }

        // Modal
        const modalData = {
            theorem1: { type: 'theorem', title: 'Theorem 1: Existence of Bias', content: '<p><strong>Condition:</strong> Given prompt $x_t$, responses with $G \\ge 2$, conditional on event $\\mathcal{S} = \\{1 \\le R \\le G-1\\}$.</p><br><p><strong>Conclusion:</strong></p><ul><li>$\\mathbb{E}[\\hat{A}_{t,i}|\\mathcal{S}] < A_{t,i}$, if $p_t < 0.5$ (hard underestimated)</li><li>$\\mathbb{E}[\\hat{A}_{t,i}|\\mathcal{S}] > A_{t,i}$, if $p_t > 0.5$ (easy overestimated)</li></ul>' },
            theorem2: { type: 'theorem', title: 'Theorem 2: Bias Probability', content: '<p>Quantifies probability of bias exceeding threshold $\\epsilon$.</p>' },
            theorem3: { type: 'theorem', title: 'Theorem 3: Advantage Rectification', content: '<p><strong>HA-DW Foundation!</strong> If $\\lambda_{scale}$ in appropriate interval, corrected bias is smaller.</p>' },
            theorem4: { type: 'theorem', title: 'Theorem 4: Continuous Reward', content: '<p>Generalizes to continuous bounded reward $r_{t,i} \\in [0,1]$.</p>' },
            lemma1: { type: 'lemma', title: 'Lemma 1/6: Baseline Rectification', content: '<p>Finds $(c_{low}, c_{high})$ independent of unknown $p_t$.</p>' },
            lemma2: { type: 'lemma', title: 'Lemma 2: Bias Quantification', content: '<p>Exact bias formula.</p>' },
            lemma3: { type: 'lemma', title: 'Lemma 3: Correction Existence', content: '<p>Existence proof for correction coefficient.</p>' },
            lemma4: { type: 'lemma', title: 'Lemma 4: Concentration Inequality', content: '<p>Hoeffding-based bound for $|\\hat{p}_t - p_t|$.</p>' },
            lemma5: { type: 'lemma', title: 'Lemma 5: Confidence Interval', content: '<p>Bounds $p_t$ range via safety radius.</p>' },
            corollary1: { type: 'corollary', title: 'Corollary 1: G≤8 Bias Probability', content: '<p>Bias probability >63% for $p_t<0.5$, >78% for $p_t<0.25$.</p>' },
            corollary2: { type: 'corollary', title: 'Corollary 2: G≥6 Bias Probability', content: '<p>Boundary case analysis for larger G.</p>' },
            corollary3: { type: 'corollary', title: 'Corollary 3: Sure Event', content: '<p>100% certain bias when $p_t < 1/G$ or $p_t > (G-1)/G$.</p>' },
            corollary4: { type: 'corollary', title: 'Corollary 4: Beta Distribution', content: '<p>Applies Theorem 4 to Beta distribution.</p>' },
            corollary5: { type: 'corollary', title: 'Corollary 5: Truncated Gaussian', content: '<p>Applies Theorem 4 to truncated Gaussian.</p>' }
        };

        function showModal(id) {
            const data = modalData[id];
            if (!data) return;
            const modal = document.getElementById('modal');
            const content = document.getElementById('modal-content');
            const colors = {
                theorem: { bg: 'var(--theorem-bg)', border: 'var(--theorem-border)' },
                lemma: { bg: 'var(--lemma-bg)', border: 'var(--lemma-border)' },
                corollary: { bg: 'var(--corollary-bg)', border: 'var(--corollary-border)' }
            };
            const c = colors[data.type];
            content.innerHTML = `
                <div style="padding: 20px; background: ${c.bg}; border-bottom: 2px solid ${c.border};">
                    <span style="padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600; text-transform: uppercase; background: ${c.border}; color: white;">${data.type}</span>
                    <h2 style="margin-top: 12px; font-size: 18px;">${data.title}</h2>
                </div>
                <div style="padding: 20px; line-height: 1.7; color: var(--text-secondary);">
                    ${data.content}
                </div>
            `;
            modal.classList.add('active');
            renderMathInElement(content, {
                delimiters: [{left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}],
                throwOnError: false
            });
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('active');
        }

        document.getElementById('modal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') closeModal();
        });
    </script>
</body>
</html>
