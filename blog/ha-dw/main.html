<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HA-DW: Your Group-Relative Advantage Is Biased</title>
    <link rel="shortcut icon" href="../../images/favicon/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <style>
        :root {
            --primary: #1a73e8;
            --primary-light: #4285f4;
            --primary-dark: #1557b0;
            --theorem-bg: #fff8e6;
            --theorem-border: #f5a623;
            --lemma-bg: #e8f4fd;
            --lemma-border: #1a73e8;
            --corollary-bg: #e6f4ea;
            --corollary-border: #34a853;
            --problem-color: #ea4335;
            --solution-color: #1a73e8;
            --generalization-color: #9334e6;
            --bg-page: #f8f9fa;
            --bg-card: #ffffff;
            --bg-sidebar: #ffffff;
            --text-primary: #202124;
            --text-secondary: #5f6368;
            --border-color: #e0e0e0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans SC', sans-serif;
            background: var(--bg-page);
            color: var(--text-primary);
            line-height: 1.7;
            font-size: 15px;
        }

        /* Page Layout */
        .page-wrapper {
            display: flex;
            min-height: 100vh;
        }

        /* Left Sidebar Navigation */
        .sidebar {
            width: 220px;
            background: var(--bg-sidebar);
            border-right: 1px solid var(--border-color);
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            overflow-y: auto;
            padding: 20px 0;
            z-index: 100;
        }

        .sidebar-header {
            padding: 10px 20px 20px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 15px;
        }

        .sidebar-header .back-link {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .sidebar-header .back-link:hover {
            color: var(--primary);
        }

        .sidebar-header h2 {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.4;
        }

        .sidebar-nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sidebar-nav li {
            margin: 2px 0;
        }

        .sidebar-nav a {
            display: block;
            padding: 10px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            border-left: 3px solid transparent;
            transition: all 0.2s;
        }

        .sidebar-nav a:hover {
            background: #f1f3f4;
            color: var(--text-primary);
        }

        .sidebar-nav a.active {
            background: #e8f0fe;
            color: var(--primary);
            border-left-color: var(--primary);
            font-weight: 500;
        }

        .sidebar-nav .nav-section {
            padding: 15px 20px 8px;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* View Toggle in Sidebar */
        .view-toggle {
            padding: 15px 20px;
            border-top: 1px solid var(--border-color);
            margin-top: 15px;
        }

        .view-toggle-label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .view-toggle-btns {
            display: flex;
            gap: 6px;
        }

        .view-toggle button {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: var(--bg-card);
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }

        .view-toggle button:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .view-toggle button.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Main Content Area */
        .main-content {
            flex: 1;
            padding: 40px 60px;
            max-width: 900px;
            margin: 0 auto;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }

            .main-content {
                padding: 20px;
                max-width: 100%;
            }

            .cards-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Header Section */
        .article-header {
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 1px solid var(--border-color);
        }

        .article-header h1 {
            font-size: 28px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 12px;
            line-height: 1.3;
        }

        .article-header .subtitle {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .article-header .meta {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .article-header .meta a {
            color: var(--primary);
            text-decoration: none;
        }

        .article-header .meta a:hover {
            text-decoration: underline;
        }

        /* Section Styles */
        .section {
            margin-bottom: 50px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
            display: inline-block;
        }

        /* Content Card */
        .content-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            border: 1px solid var(--border-color);
        }

        .content-card p {
            color: var(--text-secondary);
            margin-bottom: 12px;
            line-height: 1.8;
        }

        .content-card p:last-child {
            margin-bottom: 0;
        }

        /* Theory Structure Cards */
        .structure-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 900px) {
            .structure-grid {
                grid-template-columns: 1fr;
            }
        }

        .structure-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }

        .structure-card.problem {
            border-left-color: var(--problem-color);
        }

        .structure-card.solution {
            border-left-color: var(--solution-color);
        }

        .structure-card.generalization {
            border-left-color: var(--generalization-color);
        }

        .structure-card h3 {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .structure-card.problem h3 {
            color: var(--problem-color);
        }

        .structure-card.solution h3 {
            color: var(--solution-color);
        }

        .structure-card.generalization h3 {
            color: var(--generalization-color);
        }

        .structure-card .subtitle {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .structure-card p {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .structure-card .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .structure-card .tag {
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }

        .structure-card.problem .tag {
            background: #fce8e6;
            color: var(--problem-color);
        }

        .structure-card.solution .tag {
            background: #e8f0fe;
            color: var(--solution-color);
        }

        .structure-card.generalization .tag {
            background: #f3e8fd;
            color: var(--generalization-color);
        }

        /* Dependency Flow */
        .flow-container {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            border: 1px solid var(--border-color);
            overflow-x: auto;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .flow-section {
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            padding: 12px 10px 8px;
            position: relative;
            flex: 1;
            min-width: 200px;
        }

        .flow-section-label {
            position: absolute;
            top: -8px;
            left: 10px;
            padding: 1px 8px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 600;
            color: white;
        }

        .flow-section.problem .flow-section-label {
            background: var(--problem-color);
        }

        .flow-section.solution .flow-section-label {
            background: var(--solution-color);
        }

        .flow-section.generalization .flow-section-label {
            background: var(--generalization-color);
        }

        .flow-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
            margin: 4px 0;
        }

        .flow-node {
            background: var(--bg-card);
            border-radius: 6px;
            padding: 4px 8px;
            text-align: center;
            border: 1.5px solid;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 70px;
        }

        .flow-node:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .flow-node.theorem {
            border-color: var(--theorem-border);
            background: var(--theorem-bg);
        }

        .flow-node.lemma {
            border-color: var(--lemma-border);
            background: var(--lemma-bg);
        }

        .flow-node.corollary {
            border-color: var(--corollary-border);
            background: var(--corollary-bg);
        }

        .flow-node .node-type {
            font-size: 8px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            margin-bottom: 1px;
        }

        .flow-node.theorem .node-type { color: var(--theorem-border); }
        .flow-node.lemma .node-type { color: var(--lemma-border); }
        .flow-node.corollary .node-type { color: var(--corollary-border); }

        .flow-node .node-name {
            font-weight: 600;
            font-size: 11px;
            color: var(--text-primary);
        }

        .flow-node .node-desc {
            font-size: 8px;
            color: var(--text-secondary);
            margin-top: 1px;
        }

        .flow-arrow {
            color: var(--text-secondary);
            font-size: 12px;
        }

        .flow-arrow-down {
            text-align: center;
            color: var(--text-secondary);
            font-size: 12px;
            margin: 2px 0;
        }

        /* Symbol Grid */
        .symbol-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 12px;
        }

        .symbol-item {
            background: var(--bg-card);
            border-radius: 8px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            border: 1px solid var(--border-color);
        }

        .symbol-item .symbol {
            font-size: 16px;
            color: var(--primary);
            min-width: 50px;
        }

        .symbol-item .desc {
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* Theory Cards */
        .theory-card {
            background: var(--bg-card);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            border: 1px solid var(--border-color);
        }

        .theory-card .card-header {
            padding: 16px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .theory-card.theorem .card-header {
            background: var(--theorem-bg);
            border-bottom: 2px solid var(--theorem-border);
        }

        .theory-card.lemma .card-header {
            background: var(--lemma-bg);
            border-bottom: 2px solid var(--lemma-border);
        }

        .theory-card.corollary .card-header {
            background: var(--corollary-bg);
            border-bottom: 2px solid var(--corollary-border);
        }

        .theory-card .badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .theory-card.theorem .badge {
            background: var(--theorem-border);
            color: white;
        }

        .theory-card.lemma .badge {
            background: var(--lemma-border);
            color: white;
        }

        .theory-card.corollary .badge {
            background: var(--corollary-border);
            color: white;
        }

        .theory-card .card-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .theory-card .card-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .theory-card .card-body {
            padding: 20px;
        }

        .theory-card .card-desc {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.7;
        }

        .theory-card .card-math {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            overflow-x: auto;
            font-size: 14px;
            border: 1px solid var(--border-color);
        }

        .theory-card .card-footer {
            padding: 12px 20px;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
            font-size: 12px;
        }

        .theory-card .dep-label {
            color: var(--text-secondary);
        }

        .theory-card .dep-tag {
            padding: 3px 10px;
            border-radius: 10px;
            background: #e8e8e8;
            color: var(--text-secondary);
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .theory-card .dep-tag:hover {
            background: var(--primary);
            color: white;
        }

        /* Insight Box */
        .insight-box {
            background: var(--theorem-bg);
            border-left: 4px solid var(--theorem-border);
            border-radius: 0 8px 8px 0;
            padding: 15px 20px;
            margin: 15px 0;
        }

        .insight-box .title {
            font-weight: 600;
            color: var(--theorem-border);
            margin-bottom: 8px;
            font-size: 14px;
        }

        .insight-box p {
            color: var(--text-secondary);
            font-size: 13px;
            line-height: 1.6;
        }

        /* Cards Grid */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 20px;
        }

        @media (max-width: 500px) {
            .cards-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Experiment Section */
        .exp-card {
            background: var(--bg-card);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            border: 1px solid var(--border-color);
        }

        .exp-card .exp-header {
            padding: 16px 20px;
            background: #f8f9fa;
            border-bottom: 1px solid var(--border-color);
        }

        .exp-card .exp-header h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .exp-card .exp-header p {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .exp-card .exp-body {
            padding: 20px;
        }

        .exp-card .code-block {
            background: #1e1e1e;
            border-radius: 8px;
            padding: 15px;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 12px;
            line-height: 1.5;
            color: #d4d4d4;
        }

        .exp-card .code-block .comment { color: #6a9955; }
        .exp-card .code-block .keyword { color: #569cd6; }
        .exp-card .code-block .string { color: #ce9178; }
        .exp-card .code-block .function { color: #dcdcaa; }
        .exp-card .code-block .class-name { color: #4ec9b0; }
        .exp-card .code-block .number { color: #b5cea8; }
        .exp-card .code-block .self { color: #9cdcfe; }

        .exp-card img {
            width: 100%;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
        }

        .exp-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .exp-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
        }

        .exp-item h4 {
            font-size: 14px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .exp-item ul {
            list-style: none;
            padding: 0;
        }

        .exp-item li {
            font-size: 13px;
            color: var(--text-secondary);
            padding: 4px 0;
            padding-left: 16px;
            position: relative;
        }

        .exp-item li::before {
            content: '›';
            position: absolute;
            left: 0;
            color: var(--primary);
            font-weight: bold;
        }

        .exp-item p {
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        .legend-dot.theorem { background: var(--theorem-border); }
        .legend-dot.lemma { background: var(--lemma-border); }
        .legend-dot.corollary { background: var(--corollary-border); }

        /* Footer */
        .footer {
            text-align: center;
            padding: 30px 20px;
            border-top: 1px solid var(--border-color);
            color: var(--text-secondary);
            font-size: 13px;
            margin-top: 40px;
        }

        .footer a {
            color: var(--primary);
            text-decoration: none;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-card);
            border-radius: 12px;
            max-width: 650px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .modal-content.image-modal {
            max-width: 90vw;
            max-height: 90vh;
            background: transparent;
            box-shadow: none;
        }

        .modal-content.image-modal img {
            max-width: 100%;
            max-height: 85vh;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        /* Clickable thumbnail images */
        .exp-item img,
        .exp-body > img {
            max-width: 100%;
            max-height: 200px;
            object-fit: contain;
            cursor: pointer;
            border-radius: 8px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .exp-item img:hover,
        .exp-body > img:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #f1f3f4;
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: #e8e8e8;
        }

        /* Markdown View */
        .markdown-view {
            display: none;
            max-width: 900px;
            margin: 0 auto;
        }

        .markdown-view.active {
            display: block;
        }

        .markdown-article {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            border: 1px solid var(--border-color);
        }

        .markdown-article h1 {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
        }

        .markdown-article h2 {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            margin-top: 30px;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
        }

        .markdown-article h3 {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary);
            margin-top: 25px;
            margin-bottom: 12px;
        }

        .markdown-article p {
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .markdown-article ul, .markdown-article ol {
            color: var(--text-secondary);
            margin-bottom: 15px;
            padding-left: 25px;
        }

        .markdown-article li {
            margin-bottom: 8px;
        }

        .markdown-article blockquote {
            border-left: 4px solid var(--primary);
            margin: 20px 0;
            padding: 15px 20px;
            background: #f8f9fa;
            color: var(--text-secondary);
            border-radius: 0 8px 8px 0;
        }

        .markdown-article code {
            background: #f1f3f4;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'SF Mono', Consolas, monospace;
            font-size: 0.9em;
        }

        .markdown-article pre {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 16px;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid var(--border-color);
        }

        .markdown-article pre code {
            background: none;
            padding: 0;
        }

        .markdown-article img {
            max-width: 100%;
            border-radius: 8px;
            margin: 15px 0;
        }

        .markdown-article strong {
            color: var(--text-primary);
        }

        .visual-view {
            max-width: 900px;
        }

        .visual-view.hidden {
            display: none !important;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }

            .main-content {
                margin-left: 0;
                padding: 20px;
                max-width: 100%;
            }

            .cards-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="page-wrapper">
        <!-- Left Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="../" class="back-link">← Back to Blog</a>
                <h2>HA-DW Paper Reading</h2>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="#basic" class="active" onclick="scrollToSection('basic')">0. Basic Info</a></li>
                    <li><a href="#notation" onclick="scrollToSection('notation')">0.1 符号定义</a></li>
                    <li><a href="#grpo-recap" onclick="scrollToSection('grpo-recap')">0.2 GRPO 回顾</a></li>
                    <li><a href="#problem" onclick="scrollToSection('problem')">1. Problem</a></li>
                    <li><a href="#method" onclick="scrollToSection('method')">2. Method</a></li>
                    <li><a href="#conclusion" onclick="scrollToSection('conclusion')">3. Conclusion</a></li>
                </ul>
            </nav>
            <div class="view-toggle">
                <div class="view-toggle-label">View Mode</div>
                <div class="view-toggle-btns">
                    <button id="btn-visual" class="active" onclick="showView('visual')">Visual</button>
                    <button id="btn-md" onclick="showView('md')">Markdown</button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Visual View -->
            <div id="visual-view" class="visual-view">
                <!-- Header -->
                <header class="article-header" id="basic">
                    <h1>Your Group-Relative Advantage Is Biased</h1>
                    <p class="meta">
                        <strong>Authors:</strong> Fengkai Yang, Zherui Chen, Xiaohan Wang, et al.<br>
                        <strong>Affiliations:</strong> BUAA, UC Berkeley, PKU, Meituan<br>
                        <strong>Resources:</strong> <a href="assets/paper.pdf" target="_blank">PDF</a>
                    </p>
                </header>

                <!-- Notation -->
                <section class="section" id="notation">
                    <h2 class="section-title">0.1 符号定义 Notation</h2>

                    <div class="symbol-grid">
                        <div class="symbol-item">
                            <div class="symbol" style="font-family: 'KaTeX_Math', serif; font-size: 18px; color: var(--primary); min-width: 40px;">$t$</div>
                            <div class="symbol-desc">
                                <div style="font-weight: 500;">Training Step</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">训练步数</div>
                            </div>
                        </div>
                        <div class="symbol-item">
                            <div class="symbol" style="font-family: 'KaTeX_Math', serif; font-size: 18px; color: var(--primary); min-width: 40px;">$D$</div>
                            <div class="symbol-desc">
                                <div style="font-weight: 500;">Training Dataset</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">训练数据集</div>
                            </div>
                        </div>
                        <div class="symbol-item">
                            <div class="symbol" style="font-family: 'KaTeX_Math', serif; font-size: 18px; color: var(--primary); min-width: 40px;">$x_t$</div>
                            <div class="symbol-desc">
                                <div style="font-weight: 500;">Prompt</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">第 $t$ 步从 $D$ 中采样的 prompt</div>
                            </div>
                        </div>
                        <div class="symbol-item">
                            <div class="symbol" style="font-family: 'KaTeX_Math', serif; font-size: 18px; color: var(--primary); min-width: 40px;">$G$</div>
                            <div class="symbol-desc">
                                <div style="font-weight: 500;">Group Size</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">对 $x_t$ 生成的响应数量</div>
                            </div>
                        </div>
                        <div class="symbol-item">
                            <div class="symbol" style="font-family: 'KaTeX_Math', serif; font-size: 18px; color: var(--primary); min-width: 40px;">$R$</div>
                            <div class="symbol-desc">
                                <div style="font-weight: 500;">Total Reward</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">组内总奖励 $R=\sum_{i=1}^G r_{t,i}$</div>
                            </div>
                        </div>
                        <div class="symbol-item">
                            <div class="symbol" style="font-family: 'KaTeX_Math', serif; font-size: 18px; color: var(--primary); min-width: 40px;">$\{y_{t,i}\}$</div>
                            <div class="symbol-desc">
                                <div style="font-weight: 500;">Responses</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">对 $x_t$ 的 $G$ 个响应</div>
                            </div>
                        </div>
                        <div class="symbol-item">
                            <div class="symbol" style="font-family: 'KaTeX_Math', serif; font-size: 18px; color: var(--primary); min-width: 40px;">$r_{t,i}$</div>
                            <div class="symbol-desc">
                                <div style="font-weight: 500;">Reward</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">响应 $y_{t,i}$ 的标量奖励，$r_{t,i}\in \{0, 1\}$</div>
                            </div>
                        </div>
                        <div class="symbol-item">
                            <div class="symbol" style="font-family: 'KaTeX_Math', serif; font-size: 18px; color: var(--primary); min-width: 40px;">$\pi_{\theta}$</div>
                            <div class="symbol-desc">
                                <div style="font-weight: 500;">Policy Model</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">策略模型，即 LLM</div>
                            </div>
                        </div>
                        <div class="symbol-item">
                            <div class="symbol" style="font-family: 'KaTeX_Math', serif; font-size: 18px; color: var(--primary); min-width: 40px;">$p_t$</div>
                            <div class="symbol-desc">
                                <div style="font-weight: 500;">True Success Prob</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">真实成功概率（难度指标）</div>
                            </div>
                        </div>
                        <div class="symbol-item">
                            <div class="symbol" style="font-family: 'KaTeX_Math', serif; font-size: 18px; color: var(--primary); min-width: 40px;">$\hat{p}_t$</div>
                            <div class="symbol-desc">
                                <div style="font-weight: 500;">Estimated Success Prob</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">组内估计成功率 $\hat{p}_t = \frac{1}{G}\sum_{i=1}^G r_{t,i}$</div>
                            </div>
                        </div>
                        <div class="symbol-item">
                            <div class="symbol" style="font-family: 'KaTeX_Math', serif; font-size: 18px; color: var(--primary); min-width: 40px;">$A_{t,i}$</div>
                            <div class="symbol-desc">
                                <div style="font-weight: 500;">True Advantage</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">真实优势值 $A_{t,i} = r_{t,i} - p_t$</div>
                            </div>
                        </div>
                        <div class="symbol-item">
                            <div class="symbol" style="font-family: 'KaTeX_Math', serif; font-size: 18px; color: var(--primary); min-width: 40px;">$\hat{A}_{t,i}$</div>
                            <div class="symbol-desc">
                                <div style="font-weight: 500;">Estimated Advantage</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">组内估计优势值 $\hat{A}_{t,i} = r_{t,i} - \hat{p}_t$</div>
                            </div>
                        </div>
                        <div class="symbol-item">
                            <div class="symbol" style="font-family: 'KaTeX_Math', serif; font-size: 18px; color: var(--primary); min-width: 40px;">$\mathcal{S}$</div>
                            <div class="symbol-desc">
                                <div style="font-weight: 500;">Non-degenerate Event</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">非退化事件 $\mathcal{S} = \{1 \le R \le G-1\}$</div>
                            </div>
                        </div>
                        <div class="symbol-item">
                            <div class="symbol" style="font-family: 'KaTeX_Math', serif; font-size: 18px; color: var(--primary); min-width: 40px;">$C_t$</div>
                            <div class="symbol-desc">
                                <div style="font-weight: 500;">Difficulty Anchor</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">演变的难度锚点</div>
                            </div>
                        </div>
                        <div class="symbol-item">
                            <div class="symbol" style="font-family: 'KaTeX_Math', serif; font-size: 18px; color: var(--primary); min-width: 40px;">$\lambda_{scale}$</div>
                            <div class="symbol-desc">
                                <div style="font-weight: 500;">Scaling Factor</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">缩放系数，用于修正 bias</div>
                            </div>
                        </div>
                        <div class="symbol-item">
                            <div class="symbol" style="font-family: 'KaTeX_Math', serif; font-size: 18px; color: var(--primary); min-width: 40px;">$\Phi_{t,i}$</div>
                            <div class="symbol-desc">
                                <div style="font-weight: 500;">Correction Coefficient</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">HA-DW 修正系数</div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- GRPO Recap -->
                <section class="section" id="grpo-recap">
                    <h2 class="section-title">0.2 A Recap on GRPO</h2>

                    <div class="content-card">
                        <p>GRPO 的训练目标函数：</p>
                        <div class="card-math" style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 15px 0; overflow-x: auto;">
                            $$\mathcal{J}_{GRPO}(\theta) = \mathbb{E}_{x_t \sim D, \{y_{t,i}\}_{i=1}^G \sim \pi_{\theta_{old}}(\cdot|x_t)} \left[ \frac{1}{G} \sum_{i=1}^{G} \frac{1}{|y_{t,i}|} \sum_{j=1}^{|y_{t,i}|} \left( \min\left( \rho_{t,i,j}(\theta) \hat{A}_{t,i}, \text{clip}(\rho_{t,i,j}(\theta), 1-\varepsilon, 1+\varepsilon) \hat{A}_{t,i} \right) - \beta \mathbb{D}_{KL}(\pi_\theta \| \pi_{ref}) \right) \right]$$
                        </div>
                        <p>其中 $|y_{t,i}|$ 是第 $i$ 个回答的长度（token 数），</p>
                        <div class="card-math" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
                            $$\rho_{t,i,j}(\theta) = \frac{\pi_\theta(o_{t,i,j} | x_t, o_{t,i,&lt;j})}{\pi_{\theta_{old}}(o_{t,i,j} | x_t, o_{t,i,&lt;j})}$$
                        </div>
                        <p>$\rho_{t,i,j}(\theta)$ 是重要性采样比率，$o_{t,i,j}$ 表示第 $i$ 个回答的第 $j$ 个 token。</p>
                        <div class="card-math" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
                            $$\hat{A}_{t,i} = \frac{r_{t,i} - \text{mean}(\{r_{t,1}, r_{t,2}, \cdots, r_{t,G}\})}{\text{std}(\{r_{t,1}, r_{t,2}, \cdots, r_{t,G}\})}$$
                        </div>
                    </div>
                </section>

                <!-- Problem & Motivation -->
                <section class="section" id="problem">
                    <h2 class="section-title">1. Problem</h2>

                    <h3 style="margin-top: 20px; margin-bottom: 15px; font-size: 16px; color: var(--primary);">1.1. 论文试图解决什么问题？</h3>
                    <div class="content-card">
                        <p>A fundamental issue of group-based RL: the group-relative advantage estimator is inherently biased relative to the true (expected) advantage.</p>
                        <p>注：其实这里有一个前提条件是对于 non-degenerate event 才会发生这样的现象，所谓的"退化"是指训练中无效数据，"非退化"就是指有效数据。</p>
                        <p>为什么 GRPO 训练中会有无效数据：如果题目特别难或特别简单，reward 都是 0 或 1，计算出 advantage 为 0，导致训练梯度为 0，对于模型训练没有帮助。</p>
                    </div>

                    <h3 style="margin-top: 25px; margin-bottom: 15px; font-size: 16px; color: var(--primary);">1.2. 对于这个问题的客观了解？</h3>
                    <div class="content-card">
                        <p><strong>这是一个新问题吗？</strong>We provide the first theoretical analysis showing that it systematically underestimates advantages for hard prompts and overestimates them for easy prompts, leading to imbalanced exploration and exploitation. 他们是第一个从理论上证明了这个问题的存在，在这之前有相似但不完全相同的工作：</p>
                        <p>1. <strong>Dr.GRPO</strong>（CoLM'25）去掉了 std 标准化，认为当 reward 差异不大的时候，advantage 的差异会被 std 放大，导致训练效果不佳，但实际中目前工程上主流的做法是去掉这些 degenerate event</p>
                        <p>2. <strong>MAPO</strong>（arXiv:2509.18849）发现 GRPO 存在 Advantage Reversion 和 Advantage Mirror 的问题，但仔细推敲不是很严谨（ICLR26 分数 2242 撤稿）</p>
                        <p><strong>为什么值得研究？</strong>因为 non-degenerate group-based RL is biased</p>
                    </div>

                    <h3 style="margin-top: 25px; margin-bottom: 15px; font-size: 16px; color: var(--primary);">1.3. 这篇文章要验证一个什么科学假设？</h3>
                    <div class="content-card">
                        <p>要验证 non-degenerate group-relative advantage estimation is biased。</p>
                        <p>论文先证明了这个 bias 存在（Theorem 1），然后求出了这个 bias 存在的概率与问题难度之间关系的表达式（Theorem 2），表明难度越大或越小都会导致 bias 越大，最终设计了修正系数 λ 来修正这个偏差，并求出了这个 λ 在一个区间范围内以 δ 的置信度来实现纠偏（Theorem 3）。另外，为确保理论完整性，作者还证明了在连续有界 reward 的情况下（以 Beta 分布和 Gaussian 分布为例），这个 bias 问题依旧存在（Theorem 4）。</p>
                    </div>

                    <h3 style="margin-top: 25px; margin-bottom: 15px; font-size: 16px; color: var(--primary);">1.4. 有哪些相关研究？</h3>
                    <div class="content-card">
                        <p>大概分为：</p>
                        <p>1. <strong>训练稳定性角度</strong>：GMPO、FAPO、KATE</p>
                        <p>2. <strong>序列长度退化</strong>：LSPO、GSPO、p-GSPO</p>
                        <p>3. <strong>生成多样性</strong>：DaGRPO、DCPO</p>
                        <p>4. <strong>优势值估计</strong>：Dr.GRPO、MAPO</p>
                    </div>
                </section>

                <!-- Method -->
                <section class="section" id="method">
                    <h2 class="section-title">2. Method</h2>

                    <h3 style="margin-top: 20px; margin-bottom: 15px; font-size: 16px; color: var(--primary);" id="method-key">2.1. 我的理解：论文中提到的解决方案之关键</h3>
                    <div class="content-card" style="margin-bottom: 20px;">
                        <p>这篇论文的关键在于从理论上证明这个 bias 存在（在一定的前提条件下），然后提出了用一个系数 λ 来修正优势值，并给出严格证明表明理论上存在这样一个系数使得达到预期修正效果。</p>
                    </div>
                    <div class="structure-grid">
                        <div class="structure-card problem">
                            <h3>Part I: Reveal Bias</h3>
                            <div class="subtitle">The Problem</div>
                            <p>Prove that Group-Relative Advantage estimation is mathematically biased</p>
                            <div class="tags">
                                <span class="tag">Theorem 1</span>
                                <span class="tag">Theorem 2</span>
                                <span class="tag">Lemma 2</span>
                                <span class="tag">Corollary 1-3</span>
                            </div>
                        </div>
                        <div class="structure-card solution">
                            <h3>Part II: Solve Bias</h3>
                            <div class="subtitle">The Solution</div>
                            <p>Derive how to eliminate bias through correction coefficient $\lambda_{scale}$</p>
                            <div class="tags">
                                <span class="tag">Theorem 3</span>
                                <span class="tag">Lemma 1</span>
                                <span class="tag">Lemma 3-6</span>
                            </div>
                        </div>
                        <div class="structure-card generalization">
                            <h3>Part III: Generalization</h3>
                            <div class="subtitle">Extension</div>
                            <p>Prove bias exists not only in binary rewards, but also in continuous rewards</p>
                            <div class="tags">
                                <span class="tag">Theorem 4</span>
                                <span class="tag">Corollary 4-5</span>
                            </div>
                        </div>
                    </div>

                    <h3 style="margin-top: 35px; margin-bottom: 15px; font-size: 16px; color: var(--primary);" id="method-experiment">2.2. 客观描述：论文实验设计（理论证明）</h3>

                    <!-- Theorems -->
                    <h4 style="margin-top: 20px; margin-bottom: 15px; font-size: 15px; color: var(--text-primary);">Theorems</h4>
                    <div class="cards-grid">
                        <div class="theory-card theorem" id="theorem1">
                            <div class="card-header">
                                <span class="badge">Theorem 1</span>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Given a prompt $x_t \sim D$, let $y_{t,i} \sim \pi_{\theta}(\cdot|x_t)$ denote a sample response with reward $r_{t,i}$. Suppose $G\ge 2$, and condition on the event $\mathcal{S}=\{1\le R \le G-1\}$. Then, for any $i\in [G]$, we have:
                                </p>
                                <div class="card-math">
                                    $\mathbb{E}[\hat{A}_{t,i}|\mathcal{S}] < A_{t,i}$, if $p_t < 0.5$<br>
                                    $\mathbb{E}[\hat{A}_{t,i}|\mathcal{S}] > A_{t,i}$, if $p_t > 0.5$<br>
                                    $\mathbb{E}[\hat{A}_{t,i}|\mathcal{S}] = A_{t,i}$, if and only if $p_t = 0.5$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Depends:</span>
                                <span class="dep-tag" onclick="scrollToCard('lemma2')">Lemma 2</span>
                            </div>
                        </div>

                        <div class="theory-card theorem" id="theorem2">
                            <div class="card-header">
                                <span class="badge">Theorem 2</span>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Under the condition of Theorem 1, suppose $x_t$ is a hard prompt ($p_t < 0.5$). Then, for any $\epsilon \in (0, \mathbb{E}[\hat{p}_t|\mathcal{S}] - p_t)$, we have:
                                </p>
                                <div class="card-math">
                                    $\mathbb{P}(A_{t,i} - \hat{A}_{t,i} > \epsilon | \mathcal{S}) = \frac{\sum_{k=\lfloor G(p_t+\epsilon)\rfloor+1}^{G-1} \binom{G}{k} p_t^k (1-p_t)^{G-k}}{1 - (1-p_t)^G - p_t^G}$
                                </div>
                                <p class="card-desc" style="margin-top: 10px;">
                                    Similarly, suppose $x_t$ is an easy prompt ($p_t > 0.5$). Then, for any $\epsilon \in (0, p_t - \mathbb{E}[\hat{p}_t|\mathcal{S}])$, we have:
                                </p>
                                <div class="card-math">
                                    $\mathbb{P}(\hat{A}_{t,i} - A_{t,i} > \epsilon | \mathcal{S}) = \frac{\sum_{k=1}^{\lceil G(p_t-\epsilon)\rceil-1} \binom{G}{k} p_t^k (1-p_t)^{G-k}}{1 - (1-p_t)^G - p_t^G}$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Depends:</span>
                                <span class="dep-tag" onclick="scrollToCard('theorem1')">Theorem 1</span>
                            </div>
                        </div>

                        <div class="theory-card theorem" id="theorem3">
                            <div class="card-header">
                                <span class="badge">Theorem 3 ★</span>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Under the condition of Lemma 1, suppose there exists a scaling factor $\lambda_{scale}$ such that:
                                </p>
                                <div class="card-math">
                                    $\lambda_{scale} \in (\frac{1+\frac{(1-c_{high})\hat{p}_t}{1-\hat{p}_t}}{\exp(D_{t,i} M_t)}, \frac{1+\frac{(1-c_{low})\hat{p}_t}{1-\hat{p}_t}}{\exp(D_{t,i} M_t)}) \cup (\frac{c_{low}}{\exp(D_{t,i} M_t)}, \frac{c_{high}}{\exp(D_{t,i} M_t)})$
                                </div>
                                <p class="card-desc" style="margin-top: 10px;">
                                    Then, HA-DW algorithm provably mitigates the bias of group-relative advantage:
                                </p>
                                <div class="card-math">
                                    $|\mathbb{E}[\hat{A}_{t,i} \cdot \Phi_{t,i} | \mathcal{S}] - A_{t,i}| < |\mathbb{E}[\hat{A}_{t,i} | \mathcal{S}] - A_{t,i}|$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Depends:</span>
                                <span class="dep-tag" onclick="scrollToCard('lemma1')">Lemma 1</span>
                                <span class="dep-tag" onclick="scrollToCard('lemma6')">Lemma 6</span>
                            </div>
                        </div>

                        <div class="theory-card theorem" id="theorem4">
                            <div class="card-header">
                                <span class="badge">Theorem 4</span>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    At training step $t$, let $G \ge 2$, with CDF $F$ and PDF $f$. Given a prompt $x_t \sim \mathcal{D}$ and draw $G \ge 2$ i.i.d. rewards: $r_{t,1}, ..., r_{t,G} \sim \mathcal{D}(p_t)$. Extend the binary reward setting to non-binary rewards: $r_{t,i} \in [0, 1]$.
                                </p>
                                <p class="card-desc" style="margin-top: 10px;">
                                    Fix a constant $\sigma \in [0, 1]$ and define the update event: $\mathcal{S}_{\sigma} := \{\exists i \ne j : |r_{t,i} - r_{t,j}| > \sigma\}$
                                </p>
                                <p class="card-desc" style="margin-top: 10px;">
                                    The conditional bias transferred to advantages satisfies, for all $i$:
                                </p>
                                <div class="card-math">
                                    $\mathbb{E}[\hat{A}_{t,i} - A_{t,i} | \mathcal{S}_{\sigma}] = p_t - \mathbb{E}[\hat{p}_t | \mathcal{S}_{\sigma}]$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Generalizes:</span>
                                <span class="dep-tag" onclick="scrollToCard('theorem1')">Theorem 1</span>
                                <span class="dep-tag" onclick="scrollToCard('theorem2')">Theorem 2</span>
                            </div>
                        </div>
                    </div>

                    <!-- Lemmas -->
                    <h4 style="margin-top: 25px; margin-bottom: 15px; font-size: 15px; color: var(--text-primary);">Lemmas</h4>
                    <div class="cards-grid">
                        <div class="theory-card lemma" id="lemma1">
                            <div class="card-header">
                                <span class="badge">Lemma 1</span>
                                <div>
                                    <div class="card-title">Baseline Rectification</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Given a prompt $x_t \sim D$ and the policy $\pi_{\theta_t}$, let $\tilde{p}_t = c \cdot \hat{p}_t$ be the rectified group baseline. Assume $p_t \in [\Delta, 1-\Delta]$ for some $\Delta \in (0, 1/2]$. Given any $\delta \in (0, 1)$, define:
                                </p>
                                <div class="card-math">
                                    $\epsilon_{\delta} := \sqrt{\frac{1}{2G} \log(\frac{2}{\delta(1-(1-\Delta)^G-\Delta^G)})}$
                                </div>
                                <p class="card-desc" style="margin-top: 10px;">
                                    Let $I_t := [\hat{p}_t - \epsilon_{\delta}, \hat{p}_t + \epsilon_{\delta}] \cap [\Delta, 1-\Delta]$, $A(p) := 1 - (1-p)^G - p^G$. Fix any $\epsilon > 0$:
                                </p>
                                <div class="card-math">
                                    $c_{low} := \sup_{p \in I_t} \frac{(p-\epsilon) A(p)}{p(1-p^{G-1})}$, $c_{high} := \inf_{p \in I_t} \frac{(p+\epsilon) A(p)}{p(1-p^{G-1})}$
                                </div>
                                <p class="card-desc" style="margin-top: 10px;">
                                    Then, with probability at least $1-\delta$ conditional on $\mathcal{S}$, for any choice $c \in (c_{low}, c_{high})$:
                                </p>
                                <div class="card-math">
                                    $\mathbb{E}[\tilde{p}_t | \mathcal{S}] \in (p_t - \epsilon, p_t + \epsilon)$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Depends:</span>
                                <span class="dep-tag" onclick="scrollToCard('lemma4')">Lemma 4</span>
                                <span class="dep-tag" onclick="scrollToCard('lemma5')">Lemma 5</span>
                            </div>
                        </div>

                        <div class="theory-card lemma" id="lemma2">
                            <div class="card-header">
                                <span class="badge">Lemma 2</span>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Under the condition of Theorem 1, the bias induced by the group-relative advantage is formulated as:
                                </p>
                                <div class="card-math">
                                    $A_{t,i} - \mathbb{E}[\hat{A}_{t,i}|\mathcal{S}] = \frac{p_t(1-p_t)^G + p_t^{G+1} - p_t^G}{1 - (1-p_t)^G - p_t^G}$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Used by:</span>
                                <span class="dep-tag" onclick="scrollToCard('theorem1')">Theorem 1</span>
                            </div>
                        </div>

                        <div class="theory-card lemma" id="lemma3">
                            <div class="card-header">
                                <span class="badge">Lemma 3</span>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Define the non-degenerate event $\mathcal{S} := \{1 \le S \le G-1\}$, and $\epsilon \in (0, |p_t - \hat{p}_t|)$. If
                                </p>
                                <div class="card-math">
                                    $c \in (\frac{(p_t - \epsilon) \cdot (1 - (1-p_t)^G - p_t^G)}{p_t (1 - p_t^{G-1})}, \frac{(p_t + \epsilon) \cdot (1 - (1-p_t)^G - p_t^G)}{p_t (1 - p_t^{G-1})})$
                                </div>
                                <p class="card-desc" style="margin-top: 10px;">we have:</p>
                                <div class="card-math">
                                    $\mathbb{E}[\tilde{p}_t | \mathcal{S}] \in (p_t - \epsilon, p_t + \epsilon)$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Used by:</span>
                                <span class="dep-tag" onclick="scrollToCard('lemma1')">Lemma 1</span>
                            </div>
                        </div>

                        <div class="theory-card lemma" id="lemma4">
                            <div class="card-header">
                                <span class="badge">Lemma 4</span>
                                <div>
                                    <div class="card-title">$p_t$-free concentration under $\mathcal{S}$</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Define the non-degenerate event $\mathcal{S} := \{1 \le S \le G-1\}$. Assume $p_t \in [\Delta, 1-\Delta]$ for some $\Delta \in (0, 1/2]$. Then for any $\zeta > 0$:
                                </p>
                                <div class="card-math">
                                    $\mathbb{P}(|\hat{p}_t - p_t| < \zeta | \mathcal{S}) \ge \frac{1 - 2 \exp(-2G\zeta^2) - (1-\Delta)^G - \Delta^G}{1 - (1-\Delta)^G - \Delta^G}$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Used by:</span>
                                <span class="dep-tag" onclick="scrollToCard('lemma1')">Lemma 1</span>
                                <span class="dep-tag" onclick="scrollToCard('lemma5')">Lemma 5</span>
                            </div>
                        </div>

                        <div class="theory-card lemma" id="lemma5">
                            <div class="card-header">
                                <span class="badge">Lemma 5</span>
                                <div>
                                    <div class="card-title">Conditional $p_t$-free concentration under $\mathcal{S}$</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Assume $p_t \in [\Delta, 1-\Delta]$ for some $\Delta \in (0, 1/2]$. Then for any $\delta \in (0, 1)$, with probability at least $1-\delta$ conditional on $\mathcal{S}$:
                                </p>
                                <div class="card-math">
                                    $|\hat{p}_t - p_t| < \sqrt{\frac{1}{2G} \log(\frac{2}{\delta(1 - (1-\Delta)^G - \Delta^G)})}$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Depends:</span>
                                <span class="dep-tag" onclick="scrollToCard('lemma4')">Lemma 4</span>
                            </div>
                        </div>

                        <div class="theory-card lemma" id="lemma6">
                            <div class="card-header">
                                <span class="badge">Lemma 6</span>
                                <div>
                                    <div class="card-title">A $p_t$-free feasible range of c expressed via $\hat{p}_t$</div>
                                </div>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Assume the conditions of Lemma 4 and define $\epsilon_{\delta}$, $I_t$, $A(p)$, $c_{low}$, $c_{high}$ as in Lemma 1.
                                </p>
                                <p class="card-desc" style="margin-top: 10px;">
                                    Then, on the event $\{|\hat{p}_t - p_t| < \epsilon_{\delta}\}$ (which holds with probability at least $1-\delta$ conditional on $\mathcal{S}$), any choice $c \in (c_{low}, c_{high})$ implies:
                                </p>
                                <div class="card-math">
                                    $\mathbb{E}[\tilde{p}_t | \mathcal{S}] \in (p_t - \epsilon, p_t + \epsilon)$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Depends:</span>
                                <span class="dep-tag" onclick="scrollToCard('lemma4')">Lemma 4</span>
                                <span class="dep-tag" onclick="scrollToCard('lemma5')">Lemma 5</span>
                            </div>
                        </div>
                    </div>

                    <!-- Corollaries -->
                    <h4 style="margin-top: 25px; margin-bottom: 15px; font-size: 15px; color: var(--text-primary);">Corollaries</h4>
                    <div class="cards-grid">
                        <div class="theory-card corollary" id="corollary1">
                            <div class="card-header">
                                <span class="badge">Corollary 1</span>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Under the condition of Theorem 2, suppose the group size satisfies $2 \le G \le 8$, and assume that $p_t$ is uniformly distributed over $[0, 1]$. Then, for any $i \in [G]$:
                                </p>
                                <div class="card-math">
                                    $\mathbb{P}(\hat{A}_{t,i} < A_{t,i} | \mathcal{S}, p_t < 0.5) > 0.63$<br>
                                    $\mathbb{P}(\hat{A}_{t,i} > A_{t,i} | \mathcal{S}, p_t > 0.5) > 0.63$<br>
                                    $\mathbb{P}(\hat{A}_{t,i} < A_{t,i} | \mathcal{S}, p_t < 0.25) > 0.78$<br>
                                    $\mathbb{P}(\hat{A}_{t,i} > A_{t,i} | \mathcal{S}, p_t > 0.75) > 0.78$<br>
                                    $\mathbb{P}(\hat{A}_{t,i} < A_{t,i} | \mathcal{S}, p_t < 0.125) = 1.00$<br>
                                    $\mathbb{P}(\hat{A}_{t,i} > A_{t,i} | \mathcal{S}, p_t > 0.875) = 1.00$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Depends:</span>
                                <span class="dep-tag" onclick="scrollToCard('theorem2')">Theorem 2</span>
                            </div>
                        </div>

                        <div class="theory-card corollary" id="corollary2">
                            <div class="card-header">
                                <span class="badge">Corollary 2</span>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Under the condition of Corollary 1, suppose $G \ge 6$. The following inequalities hold:
                                </p>
                                <div class="card-math">
                                    $\mathbb{P}(\hat{A}_{t,i} < A_{t,i} | \mathcal{S}, p_t < \frac{2}{G}) > 0.78$<br>
                                    $\mathbb{P}(\hat{A}_{t,i} > A_{t,i} | \mathcal{S}, p_t > \frac{G-2}{G}) > 0.78$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Depends:</span>
                                <span class="dep-tag" onclick="scrollToCard('corollary1')">Corollary 1</span>
                            </div>
                        </div>

                        <div class="theory-card corollary" id="corollary3">
                            <div class="card-header">
                                <span class="badge">Corollary 3</span>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Under the condition of Theorem 2, suppose $G \ge 2$. Then, for any $i \in [G]$, the following inequalities hold surely:
                                </p>
                                <div class="card-math">
                                    $\hat{A}_{t,i} < A_{t,i}$, if $p_t < \frac{1}{G}$<br>
                                    $\hat{A}_{t,i} > A_{t,i}$, if $p_t > \frac{G-1}{G}$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Depends:</span>
                                <span class="dep-tag" onclick="scrollToCard('theorem2')">Theorem 2</span>
                            </div>
                        </div>

                        <div class="theory-card corollary" id="corollary4">
                            <div class="card-header">
                                <span class="badge">Corollary 4</span>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    For $Beta(\alpha, \beta)$ reward distribution, the Beta density is:
                                </p>
                                <div class="card-math">
                                    $f(x) = \frac{x^{\alpha-1}(1-x)^{\beta-1}}{B(\alpha, \beta)}$
                                </div>
                                <p class="card-desc" style="margin-top: 10px;">
                                    and the CDF is $F(x) = I_x(\alpha, \beta)$ for $x \in [0, 1]$. In particular:
                                </p>
                                <div class="card-math">
                                    $p_t = \mathbb{E}[r_{t,1}] = \frac{\alpha}{\alpha+\beta}$
                                </div>
                                <p class="card-desc" style="margin-top: 10px;">
                                    Moreover: $q(u) = I_{u^+}(\alpha, \beta) - I_u(\alpha, \beta)$, and the conditional mean:
                                </p>
                                <div class="card-math">
                                    $m(u) = \frac{B_{u^+}(\alpha+1, \beta) - B_u(\alpha+1, \beta)}{B_{u^+}(\alpha, \beta) - B_u(\alpha, \beta)}$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Depends:</span>
                                <span class="dep-tag" onclick="scrollToCard('theorem4')">Theorem 4</span>
                            </div>
                        </div>

                        <div class="theory-card corollary" id="corollary5">
                            <div class="card-header">
                                <span class="badge">Corollary 5</span>
                            </div>
                            <div class="card-body">
                                <p class="card-desc">
                                    Let the reward $Z_{t,1}, ..., Z_{t,G}$ be i.i.d. $\mathcal{N}(\mu, \xi^2)$ with $\xi > 0$, and define $r_{t,i}$ to be properly truncated to $[0, 1]$.
                                </p>
                                <p class="card-desc" style="margin-top: 10px;">
                                    Let $\Phi$ and $\varphi$ be the standard normal CDF and PDF, and set $a := \frac{0-\mu}{\xi}$, $b := \frac{1-\mu}{\xi}$. Then the truncated-normal density on $[0, 1]$ is:
                                </p>
                                <div class="card-math">
                                    $f(x) = \frac{\varphi(\frac{x-\mu}{\xi})}{\xi(\Phi(b) - \Phi(a))} \mathbf{1}_{[0,1]}(x)$
                                </div>
                                <p class="card-desc" style="margin-top: 10px;">
                                    The mean satisfies:
                                </p>
                                <div class="card-math">
                                    $p_t = \mu + \xi \frac{\varphi(a) - \varphi(b)}{\Phi(b) - \Phi(a)}$
                                </div>
                            </div>
                            <div class="card-footer">
                                <span class="dep-label">Depends:</span>
                                <span class="dep-tag" onclick="scrollToCard('theorem4')">Theorem 4</span>
                            </div>
                        </div>
                    </div>

                    <!-- Dependency Graph -->
                    <h4 style="margin-top: 25px; margin-bottom: 15px; font-size: 15px; color: var(--text-primary);">Dependency Graph</h4>
                        <div class="legend-item">
                            <div class="legend-dot theorem"></div>
                            <span>Theorem</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-dot lemma"></div>
                            <span>Lemma</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-dot corollary"></div>
                            <span>Corollary</span>
                        </div>
                    </div>
                    <div class="flow-container">
                        <!-- Problem Section -->
                        <div class="flow-section problem">
                            <span class="flow-section-label">Part I: Reveal Bias</span>
                            <div class="flow-row">
                                <div class="flow-node lemma">
                                    <div class="node-name">L2</div>
                                    <div class="node-desc">Bias Quantify</div>
                                </div>
                            </div>
                            <div class="flow-arrow-down">↓</div>
                            <div class="flow-row">
                                <div class="flow-node theorem">
                                    <div class="node-name">T1</div>
                                    <div class="node-desc">Existence</div>
                                </div>
                                <span class="flow-arrow">→</span>
                                <div class="flow-node theorem">
                                    <div class="node-name">T2</div>
                                    <div class="node-desc">Distribution</div>
                                </div>
                            </div>
                            <div class="flow-arrow-down">↓</div>
                            <div class="flow-row">
                                <div class="flow-node corollary">
                                    <div class="node-name">C1-3</div>
                                    <div class="node-desc">Bounds</div>
                                </div>
                            </div>
                        </div>

                        <!-- Solution Section -->
                        <div class="flow-section solution">
                            <span class="flow-section-label">Part II: Solve Bias</span>
                            <div class="flow-row">
                                <div class="flow-node lemma">
                                    <div class="node-name">L4</div>
                                    <div class="node-desc">Concentration</div>
                                </div>
                                <span class="flow-arrow">→</span>
                                <div class="flow-node lemma">
                                    <div class="node-name">L5</div>
                                    <div class="node-desc">Confidence</div>
                                </div>
                            </div>
                            <div class="flow-arrow-down">↓</div>
                            <div class="flow-row">
                                <div class="flow-node lemma">
                                    <div class="node-name">L3</div>
                                    <div class="node-desc">Existence</div>
                                </div>
                                <span class="flow-arrow">→</span>
                                <div class="flow-node lemma">
                                    <div class="node-name">L1/6</div>
                                    <div class="node-desc">Range</div>
                                </div>
                            </div>
                            <div class="flow-arrow-down">↓</div>
                            <div class="flow-row">
                                <div class="flow-node theorem">
                                    <div class="node-name">T3 ★</div>
                                    <div class="node-desc">Rectification</div>
                                </div>
                            </div>
                        </div>

                        <!-- Generalization Section -->
                        <div class="flow-section generalization">
                            <span class="flow-section-label">Part III: Extension</span>
                            <div class="flow-row">
                                <div class="flow-node theorem">
                                    <div class="node-name">T4</div>
                                    <div class="node-desc">Continuous</div>
                                </div>
                            </div>
                            <div class="flow-arrow-down">↓</div>
                            <div class="flow-row">
                                <div class="flow-node corollary">
                                    <div class="node-name">C4-5</div>
                                    <div class="node-desc">Beta/Gaussian</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h3 style="margin-top: 35px; margin-bottom: 15px; font-size: 16px; color: var(--primary);" id="method-data">2.3. 客观描述：数据集和代码</h3>

                    <div class="exp-card">
                        <div class="exp-header">
                            <h3>Training Pipeline</h3>
                            <p>Overall training framework of HA-DW algorithm</p>
                        </div>
                        <div class="exp-body">
                            <img src="assets/pipe.png" alt="Training Pipeline" onclick="showImageModal(this.src, this.alt)">
                        </div>
                    </div>

                    <div class="exp-card">
                        <div class="exp-header">
                            <h3>Experimental Setup</h3>
                            <p>Models, benchmarks and baselines</p>
                        </div>
                        <div class="exp-body">
                            <div class="exp-grid">
                                <div class="exp-item">
                                    <h4>Models</h4>
                                    <ul>
                                        <li>Qwen3-4B-Base</li>
                                        <li>Qwen3-8B-Base</li>
                                        <li>LLaMA-3.2-3B-Instruct</li>
                                    </ul>
                                </div>
                                <div class="exp-item">
                                    <h4>Benchmarks</h4>
                                    <ul>
                                        <li>MATH500</li>
                                        <li>AIME25, AMC23</li>
                                        <li>Minerva, OlympiadBench</li>
                                    </ul>
                                </div>
                                <div class="exp-item">
                                    <h4>Baselines</h4>
                                    <ul>
                                        <li>GRPO</li>
                                        <li>GSPO</li>
                                        <li>DAPO</li>
                                    </ul>
                                </div>
                                <div class="exp-item">
                                    <h4>Resources</h4>
                                    <p>8× NVIDIA A100 GPUs</p>
                                </div>
                                <div class="exp-item">
                                    <h4>Codebase</h4>
                                    <p>问了作者等中了再开源，基于 VeRL 框架，应该改起来问题不大</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="exp-card">
                        <div class="exp-header">
                            <h3>Solution</h3>
                            <p>First, they introduce a framework that incorporates cross-batch information into RL training, enabling a history-aware anchor for prompt difficulty. Second, they design an adaptive advantage reweighting algorithm to correct the induced bias.</p>
                        </div>
                        <div class="exp-body">
                            <div class="exp-grid" style="grid-template-columns: 1fr 1fr;">
                                <div class="exp-item">
                                    <h4>Evolving Difficulty Anchor</h4>
                                    <p style="margin-bottom: 10px;">Anchor (a latent model belief) that tracks prompt difficulty across batches:</p>
                                    <div class="card-math" style="background: #f8f9fa; padding: 10px; border-radius: 6px; font-size: 13px;">
                                        $C_t = (1 - \eta \sigma_t)C_{t-1} + \eta \sigma_t\frac{\sum_{i=1}^{B_t}r_{t,i}}{B_t}$
                                    </div>
                                    <p style="margin-top: 10px; font-size: 12px; color: var(--text-secondary);">
                                        $\sigma_t$ and $\bar{C}_t$ are the standard deviation and average of the anchor over the past $m$ batches:<br>
                                        $\bar{C}_t = \frac{1}{m}\sum_{j=1}^{m}C_{t-j}$<br>
                                        $\sigma_t = \sqrt{\frac{1}{m}\sum_{j=1}^{m}(C_{t-j}-\bar{C}_t)^2}$
                                    </p>
                                </div>
                                <div class="exp-item">
                                    <h4>HA-DW Loss Function</h4>
                                    <p style="margin-bottom: 10px;">History Aware Adaptive Difficulty Weighting:</p>
                                    <div class="card-math" style="background: #f8f9fa; padding: 10px; border-radius: 6px; font-size: 13px;">
                                        $L_{HA-DW}(\theta) = \frac{1}{G}\sum_{i=1}^G \Psi(\frac{\pi_\theta(y_{t,i}|x_t)}{\pi_{\theta_{old}}(y_{t,i}|x_t)})\cdot \phi(\hat{A}_{t,i})\cdot \Phi_{t,i}$
                                    </div>
                                    <p style="margin-top: 10px; font-size: 12px; color: var(--text-secondary);">
                                        Correction coefficient:<br>
                                        $\Phi_{t,i} = \lambda_{scale}\cdot \exp{[-sgn(\hat{A}_{t,i})\cdot sgn(diff_{t}^{his})\cdot |diff_{t}^{his}|]}$<br>
                                        where $diff_{t}^{his} = \hat{p}_t - C_t$
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="exp-card">
                        <div class="exp-header">
                            <h3>Pseudocode</h3>
                            <p>复现伪代码（基于论文公式）</p>
                        </div>
                        <div class="exp-body">
                            <pre class="code-block"><span class="keyword">import</span> torch
<span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn
<span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">from</span> collections <span class="keyword">import</span> deque

<span class="keyword">class</span> <span class="class-name">HADW_GRPO_Trainer</span>(nn.Module):
    <span class="keyword">def</span> <span class="function">__init__</span>(<span class="self">self</span>, model, group_size=<span class="number">8</span>, m=<span class="number">50</span>, eta_base=<span class="number">0.1</span>, lambda_scale=<span class="number">1.3</span>):
        <span class="keyword">super</span>().__init__()
        <span class="self">self</span>.model = model
        <span class="self">self</span>.group_size = group_size

        <span class="comment"># --- HA-DW Hyperparameters ---</span>
        <span class="self">self</span>.m = m                       <span class="comment"># 历史窗口大小 (公式 9)</span>
        <span class="self">self</span>.eta_base = eta_base         <span class="comment"># 基础遗忘因子 (公式 11 中的 η)</span>
        <span class="self">self</span>.lambda_scale = lambda_scale <span class="comment"># 缩放系数 (公式 16)</span>

        <span class="comment"># --- HA-DW Dynamic States (核心状态) ---</span>
        <span class="self">self</span>.C_t = <span class="keyword">None</span>                  <span class="comment"># 演变的难度锚点 (公式 8)</span>
        <span class="self">self</span>.history_buffer = deque(maxlen=m) <span class="comment"># 历史 C_t 缓存，用于计算 sigma</span>

    <span class="keyword">def</span> <span class="function">update_anchor_state</span>(<span class="self">self</span>, current_batch_acc):
        <span class="string">"""更新难度锚点 C_t 的逻辑 (对应论文 Section 3.1)"""</span>
        <span class="comment"># 初始化: 如果是第一次运行，直接用当前 Batch 准确率初始化</span>
        <span class="keyword">if</span> <span class="self">self</span>.C_t <span class="keyword">is</span> <span class="keyword">None</span>:
            <span class="self">self</span>.C_t = current_batch_acc.item()
            <span class="self">self</span>.history_buffer.append(<span class="self">self</span>.C_t)
            <span class="keyword">return</span> <span class="self">self</span>.C_t

        <span class="comment"># 计算历史窗口均值 (公式 9)</span>
        C_bar = np.mean(<span class="self">self</span>.history_buffer)

        <span class="comment"># 计算历史标准差 sigma_t (公式 10)</span>
        <span class="keyword">if</span> <span class="keyword">len</span>(<span class="self">self</span>.history_buffer) < <span class="number">2</span>:
            sigma_t = <span class="number">1.0</span>
        <span class="keyword">else</span>:
            sigma_t = np.std(<span class="self">self</span>.history_buffer)

        <span class="comment"># 计算自适应遗忘因子 eta_t (公式 11)</span>
        eta_t = <span class="self">self</span>.eta_base * sigma_t

        <span class="comment"># 更新难度锚点 C_t (公式 8: Kalman-style update)</span>
        <span class="self">self</span>.C_t = (<span class="number">1</span> - eta_t) * <span class="self">self</span>.C_t + eta_t * current_batch_acc.item()
        <span class="self">self</span>.history_buffer.append(<span class="self">self</span>.C_t)

        <span class="keyword">return</span> <span class="self">self</span>.C_t

    <span class="keyword">def</span> <span class="function">forward</span>(<span class="self">self</span>, input_ids, old_log_probs, rewards):
        <span class="string">"""Training Step: 计算 Loss, rewards shape: (Batch_Size, Group_Size)"""</span>
        <span class="comment"># 计算当前 Batch 的观测值 y_t (公式 7)</span>
        y_t = rewards.mean()

        <span class="comment"># 更新全局状态 C_t</span>
        current_C_t = <span class="self">self</span>.update_anchor_state(y_t)

        <span class="comment"># --- 开始计算 HA-DW 权重 ---</span>

        <span class="comment"># 计算组基线 p_hat (公式 2)</span>
        p_hat = rewards.mean(dim=<span class="number">1</span>, keepdim=<span class="keyword">True</span>)

        <span class="comment"># 计算历史难度 diff_his (公式 13)</span>
        diff_his = p_hat - current_C_t

        <span class="comment"># 计算 GRPO 原始优势 A_hat (公式 2 & 24)</span>
        group_mean = rewards.mean(dim=<span class="number">1</span>, keepdim=<span class="keyword">True</span>)
        group_std = rewards.std(dim=<span class="number">1</span>, keepdim=<span class="keyword">True</span>) + <span class="number">1e-8</span>
        A_hat = (rewards - group_mean) / group_std

        <span class="comment"># 计算调整方向 D_ti (公式 14)</span>
        D_ti = -torch.sign(A_hat) * torch.sign(diff_his)

        <span class="comment"># 计算调整幅度 M_t (公式 15)</span>
        M_t = torch.abs(diff_his)

        <span class="comment"># 计算最终修正系数 Phi (公式 16)</span>
        Phi_ti = <span class="self">self</span>.lambda_scale * torch.exp(D_ti * M_t)

        <span class="comment"># --- 计算最终 Loss ---</span>
        ratio = torch.ones_like(rewards, requires_grad=<span class="keyword">True</span>)  <span class="comment"># 简化示例</span>

        <span class="comment"># HA-DW Loss (公式 17)</span>
        surr1 = ratio * A_hat * Phi_ti
        surr2 = torch.clamp(ratio, <span class="number">1</span> - <span class="number">0.2</span>, <span class="number">1</span> + <span class="number">0.2</span>) * A_hat * Phi_ti
        loss = -torch.min(surr1, surr2).mean()

        <span class="keyword">return</span> loss</pre>
                        </div>
                    </div>

                    <div class="exp-card">
                        <div class="exp-header">
                            <h3>Results</h3>
                            <p>Comparison with baselines</p>
                        </div>
                        <div class="exp-body">
                            <img src="assets/exp_comp.png" alt="Comparison" onclick="showImageModal(this.src, this.alt)">
                            <img src="assets/exp_improve.png" alt="Improvement" onclick="showImageModal(this.src, this.alt)">
                        </div>
                    </div>

                    <div class="exp-card">
                        <div class="exp-header">
                            <h3>Ablation Studies</h3>
                            <p>Hyperparameter analysis</p>
                        </div>
                        <div class="exp-body">
                            <div class="exp-grid">
                                <div>
                                    <img src="assets/exp_ab1.png" alt="Lambda search" onclick="showImageModal(this.src, this.alt)">
                                </div>
                                <div>
                                    <img src="assets/exp_ab2.png" alt="Dynamic Ct" onclick="showImageModal(this.src, this.alt)">
                                </div>
                            </div>
                        </div>
                    </div>

                    <h3 style="margin-top: 35px; margin-bottom: 15px; font-size: 16px; color: var(--primary);" id="method-support">2.4. 我的观点：论文中的实验及结果有没有很好地支持需要验证的科学假设？</h3>
                    <div class="content-card">
                        <p>这篇论文理论严谨，但是最终设计的 HA-DW 算法，调参得到的 $\lambda$ 没有与 Theorem 3 进行交叉验证来表明选的超参数确实符合理论推导。</p>
                        <p>通过与 GRPO、GSPO 和 DAPO 三个基线对比，该方法在所有 benchmark 上都带来了性能提升，说明对于 advantage 的修正能够使得模型训练效果更好。</p>
                    </div>
                </section>

                <!-- Conclusion -->
                <section class="section" id="conclusion">
                    <h2 class="section-title">3. Conclusion</h2>

                    <h3 style="margin-top: 20px; margin-bottom: 15px; font-size: 16px; color: var(--primary);" id="conclusion-contribution">3.1. 我的观点：这篇论文到底有什么贡献？</h3>
                    <div class="content-card">
                        <p><strong style="color: var(--corollary-border);">优点：</strong></p>
                        <p>这篇论文证明在 Bernoulli、Beta 和 Bounded Gaussian Distribution 的 reward 下，如果存在 non-degenerate 情况，则会出现 group-relative advantage 的估计存在偏差情况。</p>

                        <p style="margin-top: 15px;"><strong style="color: var(--problem-color);">缺点：</strong></p>
                        <p>1. 作者只给出了 reward 属于 Bernoulli 分布情况下的优化方法（HA-DW），存在一定的局限性，无法直接适用于其他分布情况。（因为 Theorem 3 对于 $\lambda$ 存在的证明依赖 Bernoulli 分布）</p>
                        <p>2. 作者已经通过 Theorem 3 找到了 $\lambda$ 的合理区间，但是为啥没有直接使用这个理论值，做成自适应的 $\lambda$？而是通过人为设定 task-dependent 超参数 $\eta$ 来实现，导致需要额外的调参过程，限制了这个方法的可扩展性。</p>
                        <p>3. 作者证明了 bias 的存在，但是没有完善的分析为什么存在这个 bias。</p>
                    </div>

                    <h3 style="margin-top: 25px; margin-bottom: 15px; font-size: 16px; color: var(--primary);" id="conclusion-future">3.2. 我的理解：下一步如何深入研究？</h3>
                    <div class="content-card">
                        <p>1. <a href="https://ku.baidu-int.com/knowledge/HFVrC7hq1Q/pKzJfZczuc/yxUGa6szw9/iM3YtVaSDlF9P8#anchor-docyg-dd45eb20-059c-11f1-935f-a146f918ac55" target="_blank">完善理论框架，扩展到其他 reward 分布的任务下</a></p>
                        <p>2. 跑 GRPO、GSPO、DAPO 三个 baseline，并复现 HA-DW</p>
                        <p>3. 设计新算法对 advantage bias 进行修正</p>
                    </div>
                </section>

                <footer class="footer">
                    <p>Paper Reading | HA-DW: Your Group-Relative Advantage Is Biased</p>
                    <p><a href="assets/paper.pdf" target="_blank">PDF</a></p>
                </footer>
            </div>

            <!-- Markdown View -->
            <div id="md-view" class="markdown-view">
                <article class="markdown-article" id="markdown-content">
                    <p>Loading markdown...</p>
                </article>
            </div>
        </main>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="modal">
        <button class="modal-close" onclick="closeModal()">×</button>
        <div class="modal-content" id="modal-content"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        // KaTeX rendering
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: '$$', right: '$$', display: true},
                    {left: '$', right: '$', display: false}
                ],
                throwOnError: false
            });
        });

        // Navigation
        function scrollToSection(id) {
            const el = document.getElementById(id);
            if (el) {
                el.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            // Update active state
            document.querySelectorAll('.sidebar-nav a').forEach(a => a.classList.remove('active'));
            event.target.classList.add('active');
        }

        // Scroll to theory card
        function scrollToCard(id) {
            const el = document.getElementById(id);
            if (el) {
                el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                // Highlight effect
                el.style.boxShadow = '0 0 0 3px var(--primary)';
                setTimeout(() => {
                    el.style.boxShadow = '';
                }, 1500);
            }
        }

        // Scroll spy
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('.section, .article-header');
            let current = 'basic';

            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                if (rect.top <= 100) {
                    current = section.id;
                }
            });

            document.querySelectorAll('.sidebar-nav a').forEach(a => {
                a.classList.remove('active');
                if (a.getAttribute('href') === '#' + current) {
                    a.classList.add('active');
                }
            });
        });

        // View toggle
        let mdLoaded = false;

        function showView(view) {
            const visualView = document.getElementById('visual-view');
            const mdView = document.getElementById('md-view');
            const btnVisual = document.getElementById('btn-visual');
            const btnMd = document.getElementById('btn-md');

            if (view === 'visual') {
                visualView.classList.remove('hidden');
                mdView.classList.remove('active');
                btnVisual.classList.add('active');
                btnMd.classList.remove('active');
            } else {
                visualView.classList.add('hidden');
                mdView.classList.add('active');
                btnVisual.classList.remove('active');
                btnMd.classList.add('active');
                if (!mdLoaded) {
                    loadMarkdown();
                }
            }
        }

        function loadMarkdown() {
            fetch('main.md')
                .then(response => response.text())
                .then(text => {
                    const mathPlaceholders = [];
                    text = text.replace(/\$\$([\s\S]*?)\$\$/g, (match, formula) => {
                        mathPlaceholders.push({ type: 'block', formula: formula.trim() });
                        return `%%MATH_BLOCK_${mathPlaceholders.length - 1}%%`;
                    });
                    text = text.replace(/\$([^\$\n]+?)\$/g, (match, formula) => {
                        mathPlaceholders.push({ type: 'inline', formula: formula.trim() });
                        return `%%MATH_INLINE_${mathPlaceholders.length - 1}%%`;
                    });
                    let html = marked.parse(text);
                    mathPlaceholders.forEach((item, index) => {
                        if (item.type === 'block') {
                            html = html.replace(`%%MATH_BLOCK_${index}%%`, `$$${item.formula}$$`);
                        } else {
                            html = html.replace(`%%MATH_INLINE_${index}%%`, `$${item.formula}$`);
                        }
                    });
                    const mdContent = document.getElementById('markdown-content');
                    mdContent.innerHTML = html;
                    renderMathInElement(mdContent, {
                        delimiters: [
                            {left: '$$', right: '$$', display: true},
                            {left: '$', right: '$', display: false}
                        ],
                        throwOnError: false
                    });
                    mdLoaded = true;
                })
                .catch(err => {
                    document.getElementById('markdown-content').innerHTML = '<p style="color: #ea4335;">Failed to load markdown file.</p>';
                });
        }

        // Modal
        const modalData = {
            theorem1: { type: 'theorem', title: 'Theorem 1: Existence of Bias', content: '<p><strong>Condition:</strong> Given prompt $x_t$, responses with $G \\ge 2$, conditional on event $\\mathcal{S} = \\{1 \\le R \\le G-1\\}$.</p><br><p><strong>Conclusion:</strong></p><ul><li>$\\mathbb{E}[\\hat{A}_{t,i}|\\mathcal{S}] < A_{t,i}$, if $p_t < 0.5$ (hard underestimated)</li><li>$\\mathbb{E}[\\hat{A}_{t,i}|\\mathcal{S}] > A_{t,i}$, if $p_t > 0.5$ (easy overestimated)</li></ul>' },
            theorem2: { type: 'theorem', title: 'Theorem 2: Bias Probability', content: '<p>Quantifies probability of bias exceeding threshold $\\epsilon$.</p>' },
            theorem3: { type: 'theorem', title: 'Theorem 3: Advantage Rectification', content: '<p><strong>HA-DW Foundation!</strong> If $\\lambda_{scale}$ in appropriate interval, corrected bias is smaller.</p>' },
            theorem4: { type: 'theorem', title: 'Theorem 4: Continuous Reward', content: '<p>Generalizes to continuous bounded reward $r_{t,i} \\in [0,1]$.</p>' },
            lemma1: { type: 'lemma', title: 'Lemma 1/6: Baseline Rectification', content: '<p>Finds $(c_{low}, c_{high})$ independent of unknown $p_t$.</p>' },
            lemma2: { type: 'lemma', title: 'Lemma 2: Bias Quantification', content: '<p>Exact bias formula.</p>' },
            lemma3: { type: 'lemma', title: 'Lemma 3: Correction Existence', content: '<p>Existence proof for correction coefficient.</p>' },
            lemma4: { type: 'lemma', title: 'Lemma 4: Concentration Inequality', content: '<p>Hoeffding-based bound for $|\\hat{p}_t - p_t|$.</p>' },
            lemma5: { type: 'lemma', title: 'Lemma 5: Confidence Interval', content: '<p>Bounds $p_t$ range via safety radius.</p>' },
            corollary1: { type: 'corollary', title: 'Corollary 1: G≤8 Bias Probability', content: '<p>Bias probability >63% for $p_t<0.5$, >78% for $p_t<0.25$.</p>' },
            corollary2: { type: 'corollary', title: 'Corollary 2: G≥6 Bias Probability', content: '<p>Boundary case analysis for larger G.</p>' },
            corollary3: { type: 'corollary', title: 'Corollary 3: Sure Event', content: '<p>100% certain bias when $p_t < 1/G$ or $p_t > (G-1)/G$.</p>' },
            corollary4: { type: 'corollary', title: 'Corollary 4: Beta Distribution', content: '<p>Applies Theorem 4 to Beta distribution.</p>' },
            corollary5: { type: 'corollary', title: 'Corollary 5: Truncated Gaussian', content: '<p>Applies Theorem 4 to truncated Gaussian.</p>' }
        };

        function showModal(id) {
            const data = modalData[id];
            if (!data) return;
            const modal = document.getElementById('modal');
            const content = document.getElementById('modal-content');
            const colors = {
                theorem: { bg: 'var(--theorem-bg)', border: 'var(--theorem-border)' },
                lemma: { bg: 'var(--lemma-bg)', border: 'var(--lemma-border)' },
                corollary: { bg: 'var(--corollary-bg)', border: 'var(--corollary-border)' }
            };
            const c = colors[data.type];
            content.innerHTML = `
                <div style="padding: 20px; background: ${c.bg}; border-bottom: 2px solid ${c.border};">
                    <span style="padding: 4px 12px; border-radius: 12px; font-size: 11px; font-weight: 600; text-transform: uppercase; background: ${c.border}; color: white;">${data.type}</span>
                    <h2 style="margin-top: 12px; font-size: 18px;">${data.title}</h2>
                </div>
                <div style="padding: 20px; line-height: 1.7; color: var(--text-secondary);">
                    ${data.content}
                </div>
            `;
            modal.classList.add('active');
            renderMathInElement(content, {
                delimiters: [{left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}],
                throwOnError: false
            });
        }

        function closeModal() {
            const modal = document.getElementById('modal');
            const content = document.getElementById('modal-content');
            modal.classList.remove('active');
            content.classList.remove('image-modal');
        }

        function showImageModal(src, alt) {
            const modal = document.getElementById('modal');
            const content = document.getElementById('modal-content');
            content.classList.add('image-modal');
            content.innerHTML = `<img src="${src}" alt="${alt}">`;
            modal.classList.add('active');
        }

        document.getElementById('modal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') closeModal();
        });
    </script>
</body>
</html>
